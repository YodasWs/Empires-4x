"use strict";(()=>{var e={601:(e,t,r)=>{"use strict";var n;function i(e,t){a(e,t),t.add(e)}function o(e,t,r){a(e,t),t.set(e,r)}function a(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function s(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}function c(e,t,r){return function(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}(e,l(e,t,"set"),r),r}function u(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,l(e,t,"get"))}function l(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function h(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=x(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function f(e,t){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},f(e,t)}function y(e,t){if(t&&("object"===k(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function d(e){return d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},d(e)}function v(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function g(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?v(Object(r),!0).forEach(function(t){b(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function w(e,t,r){return t&&m(e.prototype,t),r&&m(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function b(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function x(e,t){if(e){if("string"==typeof e)return O(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?O(e,t):void 0}}function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function k(e){return k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},k(e)}r.r(t);var q=function(e){return Number.isFinite(e)&&!Number.isNaN(e)},S=function(e){return"object"==k(e)&&null!==e},P=function(e){return S(e)&&q(e.col)&&q(e.row)},T=function(e){return Array.isArray(e)&&q(e[0])&&q(e[1])},j=function(e,t){return t+e*(1&t)>>1},E=function(e,t){return function(e,t){return(e%8+8)%8}(e+t)},N=function(e){var t,r,n=(r=3,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o=[],a=!0,s=!1;try{for(r=r.call(e);!(a=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);a=!0);}catch(e){s=!0,i=e}finally{try{a||null==r.return||r.return()}finally{if(s)throw i}}return o}}(t,r)||x(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=n[0],o=n[1],a=n[2];return{q:i,r:o,s:void 0===a?-i-o:a}};function R(e){var t=e.q,r=e.r,n=e.s,i=q(t),o=q(r),a=q(n);if(i&&o&&a)return{q:t,r,s:n};if(i&&o)return{q:t,r,s:-t-r};if(i&&a)return{q:t,r:-t-n,s:n};if(o&&a)return{q:-r-n,r,s:n};throw new TypeError("Can't determine three cube coordinates from less than two coordinates. Received: { q: ".concat(t,", r: ").concat(r,", s: ").concat(n," }."))}var A=function(e){return e.FLAT="FLAT",e.POINTY="POINTY",e}(A||{});var C=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0];p(this,e),b(this,"q",void 0),b(this,"r",void 0);var r=$(this,t),n=r.q,i=r.r;this.q=n,this.r=i}return w(e,[{key:"center",get:function(){var e=this.width,t=this.height;return{x:e/2-this.x,y:t/2-this.y}}},{key:"col",get:function(){return H(this).col}},{key:"corners",get:function(){var e=this.orientation,t=this.width,r=this.height,n=this.x,i=this.y;return e===A.POINTY?I(t,r,n,i):M(t,r,n,i)}},{key:"dimensions",get:function(){return U.dimensions}},{key:"height",get:function(){var e=this.orientation,t=this.dimensions.yRadius;return e===A.POINTY?2*t:t*Math.sqrt(3)}},{key:"isFlat",get:function(){return this.orientation===A.FLAT}},{key:"isPointy",get:function(){return this.orientation===A.POINTY}},{key:"orientation",get:function(){return U.orientation}},{key:"origin",get:function(){return U.origin}},{key:"offset",get:function(){return U.offset}},{key:"row",get:function(){return H(this).row}},{key:"width",get:function(){var e=this.orientation,t=this.dimensions.xRadius;return e===A.POINTY?t*Math.sqrt(3):2*t}},{key:"x",get:function(){return D(this).x}},{key:"y",get:function(){return D(this).y}},{key:"s",get:function(){return-this.q-this.r}},{key:"clone",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this;return new this.constructor(e)}},{key:"equals",value:function(e){return function(e,t){if(P(e)&&P(t))return e.col===t.col&&e.row===t.row;if(Object.hasOwn(e,"col")||Object.hasOwn(t,"col"))throw new Error("Can't compare coordinates where one are offset coordinates. Either pass two offset coordinates or two axial/cube coordinates. Received: ".concat(JSON.stringify(e)," and ").concat(JSON.stringify(t)));var r=T(e)?N(e):e,n=T(t)?N(t):t;return r.q===n.q&&r.r===n.r}(this,P(e)?G(this,e):e)}},{key:"toString",value:function(){return"".concat(this.constructor.name,"(").concat(this.q,",").concat(this.r,")")}},{key:"translate",value:function(e){return F(this,e)}}],[{key:"settings",get:function(){var e=this.prototype;return{dimensions:e.dimensions,orientation:e.orientation,origin:e.origin,offset:e.offset}}}]),e}(),U={dimensions:{xRadius:1,yRadius:1},orientation:A.POINTY,origin:{x:0,y:0},offset:-1},I=function(e,t,r,n){return[{x:r+.5*e,y:n-.25*t},{x:r+.5*e,y:n+.25*t},{x:r,y:n+.5*t},{x:r-.5*e,y:n+.25*t},{x:r-.5*e,y:n-.25*t},{x:r,y:n-.5*t}]},M=function(e,t,r,n){return[{x:r+.25*e,y:n-.5*t},{x:r+.5*e,y:n},{x:r+.25*e,y:n+.5*t},{x:r-.25*e,y:n+.5*t},{x:r-.5*e,y:n},{x:r-.25*e,y:n-.5*t}]};function W(e){var t=g(g({},U),e),r=t.dimensions,n=t.orientation,i=t.origin,o=t.offset;return function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(c,e);var t,a,s=(t=c,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,r=d(t);if(a){var n=d(this).constructor;e=Reflect.construct(r,arguments,n)}else e=r.apply(this,arguments);return y(this,e)});function c(){return p(this,c),s.apply(this,arguments)}return w(c,[{key:"dimensions",get:function(){return function(e,t){if(S(e)&&e.xRadius>0&&e.yRadius>0)return e;if(S(e)&&e.width>0&&e.height>0){var r=e.width,n=e.height;return t===A.POINTY?{xRadius:r/Math.sqrt(3),yRadius:n/2}:{xRadius:r/2,yRadius:n/Math.sqrt(3)}}if(e>0)return{xRadius:e,yRadius:e};throw new TypeError("Invalid dimensions: ".concat(JSON.stringify(e),". Dimensions must be expressed as an Ellipse ({ xRadius: number, yRadius: number }), a Rectangle ({ width: number, height: number }) or a number."))}(r,n)}},{key:"orientation",get:function(){return n}},{key:"origin",get:function(){return function(e,t){if(function(e){return S(e)&&q(e.x)&&q(e.y)}(e))return e;if(!t)throw new TypeError("Supply a bounding box ({ width: number, height: number }). Received: ".concat(JSON.stringify(t)));if("topLeft"===e)return{x:-.5*t.width,y:-.5*t.height};throw new TypeError("Invalid origin: ".concat(JSON.stringify(e),". Origin must be expressed as a Point ({ x: number, y: number }) or the string 'topLeft'."))}(i,this)}},{key:"offset",get:function(){return o}}]),c}(C)}var H=function(e){var t=e.q,r=e.r,n=e.offset;return e.isPointy?function(e,t,r){return{col:e+j(r,t),row:t}}(t,r,n):function(e,t,r){return{col:e,row:t+j(r,e)}}(t,r,n)},D=function(e){var t=e.orientation,r=e.dimensions,n=r.xRadius,i=r.yRadius,o=e.origin,a=o.x,s=o.y,c=e.q,u=e.r;return t===A.POINTY?{x:n*Math.sqrt(3)*(c+u/2)-a,y:3*i/2*u-s}:{x:3*n/2*c-a,y:i*Math.sqrt(3)*(u+c/2)-s}},L=function(e,t,r){var n=e-j(r,t);return{q:n,r:t,s:-n-t}},J=function(e,t,r){var n=e,i=t-j(r,e);return{q:n,r:i,s:-n-i}},G=function(e,t){var r=e.offset,n=e.orientation,i=t.col,o=t.row;return n===A.POINTY?L(i,o,r):J(i,o,r)},K=function(e){var t=R(e),r=t.q,n=t.r,i=t.s,o=Math.round(r),a=Math.round(n),s=Math.round(i),c=Math.abs(r-o),u=Math.abs(n-a),l=Math.abs(i-s);return c>u&&c>l?o=-a-s:u>l?a=-o-s:s=-o-a,{q:o,r:a,s}},Y=function(e,t){var r=e.dimensions,n=r.xRadius,i=r.yRadius,o=e.origin,a=e.orientation,s=t.x,c=t.y;return s+=o.x,c+=o.y,a===A.POINTY?K({q:Math.sqrt(3)*s/(3*n)-c/(3*i),r:2/3*(c/i)}):K({q:2/3*(s/n),r:Math.sqrt(3)*c/(3*i)-s/(3*n)})};function $(e,t){return T(t)?N(t):P(t)?G(e,t):R(t)}function F(e,t){var r=R(e),n=r.q,i=r.r,o=r.s,a=R(t),s={q:n+a.q,r:i+a.r,s:o+a.s};return e instanceof C?e.clone(s):s}function _(e,t,r){var n=$(e,t),i=n.q,o=n.r,a=n.s,s=$(e,r),c=s.q,u=s.r,l=s.s;return Math.max(Math.abs(i-c),Math.abs(o-u),Math.abs(a-l))}var z=function(e){return e.CLOCKWISE="CLOCKWISE",e.COUNTERCLOCKWISE="COUNTERCLOCKWISE",e}(z||{}),V=function(e){return e[e.N=0]="N",e[e.NE=1]="NE",e[e.E=2]="E",e[e.SE=3]="SE",e[e.S=4]="S",e[e.SW=5]="SW",e[e.W=6]="W",e[e.NW=7]="NW",e}(V||{}),B=[null,{q:1,r:-1},{q:1,r:0},{q:0,r:1},null,{q:-1,r:1},{q:-1,r:0},{q:0,r:-1}],Q=[{q:0,r:-1},{q:1,r:-1},null,{q:1,r:0},{q:0,r:1},{q:-1,r:1},null,{q:-1,r:0}],X=function(e,t){return e.clone(e.isPointy?function(e,t){var r=e.offset,n=e.q,i=e.r,o=e.col,a=e.row;if(t===V.S||t===V.N){var s=t===V.S?a+1:a-1;return L(o,s,r)}var c=B[t];return{q:n+c.q,r:i+c.r}}(e,t):function(e,t){var r=e.offset,n=e.q,i=e.r,o=e.col,a=e.row;if(t===V.E||t===V.W){var s=t===V.E?o+1:o-1;return J(s,a,r)}var c=Q[t];return{q:n+c.q,r:i+c.r}}(e,t))};function Z(e){return Array.isArray(e)?function(t,r){var n,i=[],o=r,a=h(e);try{for(a.s();!(n=a.n()).done;){var s,c=h((0,n.value)(t,o));try{for(c.s();!(s=c.n()).done;){var u=s.value;i.push(o=u)}}catch(e){c.e(e)}finally{c.f()}}}catch(e){a.e(e)}finally{a.f()}return i}:e}function ee(e){return function(e){return e.direction in V}(e)?function(e){var t=e.start,r=e.direction,n=e.length;return function(e,i){var o=[],a=e(null!=t?t:i);!t&&i&&(a=X(a,r));for(var s=0;s<n;s++)o.push(a),a=X(a,r);return o}}(e):function(e){var t=e.start,r=e.stop;return function(e,n){for(var i=[],o=e(null!=t?t:n),a=function(e,t){return function(r){return{q:e.q*(1-r)+t.q*r,r:e.r*(1-r)+t.r*r}}}(te(o),te($(o,r))),s=_(o,o,r),c=1/Math.max(s,1),u=!t&&n?1:0;u<=s;u++){var l=K(a(c*u));i.push(e(l))}return i}}(e)}function te(e){return{q:e.q+1e-6,r:e.r+1e-6,s:e.s+-2e-6}}function re(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.includeSource,i=void 0===n||n;return function(r,n){var o,a=[],s=h(Z(e)(r,n));try{for(s.s();!(o=s.n()).done;){var c=o.value;i&&a.push(c);var u,l=h(Z(t)(r,c));try{for(l.s();!(u=l.n()).done;){var f=u.value;a.push(f)}}catch(e){l.e(e)}finally{l.f()}}}catch(e){s.e(e)}finally{s.f()}return a}}V.E,V.N,V.S,V.W;var ne=[{q:1,r:0},{q:0,r:1},{q:-1,r:1},{q:-1,r:0},{q:0,r:-1},{q:1,r:-1}];function ie(e){var t=e.radius,r=e.start,n=e.rotation;return function(e,i){var o,a=null!==(o=null!=r?r:i)&&void 0!==o?o:[0,0],s=!r&&i?t:t+1;return re(ee({start:r,direction:V.N,length:s}),function(e){var t=e.center,r=e.rotation,n=void 0===r?z.CLOCKWISE:r;return function(r,i){var o,a,s=n.toUpperCase(),c=[],u=e.radius;q(u)?a=r(t).translate({q:u,s:-u}):u=_(a=r(null!==(o=e.start)&&void 0!==o?o:i),t,a);var l=$(a,t),h=r({q:l.q,r:l.r-u,s:l.s+u});if(s===z.CLOCKWISE)for(var f=0;f<6;f++)for(var y=0;y<u;y++){var d=ne[f],v=d.q,g=d.r;h=r({q:h.q+v,r:h.r+g}),c.push(h)}else for(var p=5;p>=0;p--)for(var m=0;m<u;m++){var w=ne[p],b=w.q,x=w.r;h=r({q:h.q-b,r:h.r-x}),c.push(h)}var O=!e.start&&i,k=c.findIndex(function(e){return e.equals(a)});return c.slice(k+(O?1:0)).concat(c.slice(0,k))}}({center:a,rotation:n}))(e,i)}}var oe=new WeakMap,ae=new WeakMap,se=new WeakSet,ce=new WeakSet,ue=new WeakSet,le=new WeakSet;n=Symbol.iterator;var he=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(p(this,e),i(this,le),i(this,ue),i(this,ce),i(this,se),o(this,oe,{writable:!0,value:void 0}),o(this,ae,{writable:!0,value:new Map}),t instanceof e)return c(this,oe,u(t,oe)),void this.setHexes(t);c(this,oe,t),this.setHexes(s(this,ce,ye).call(this,r))}return w(e,[{key:"size",get:function(){return u(this,ae).size}},{key:"pixelWidth",get:function(){if(0===this.size)return 0;var e=this.hexPrototype,t=e.isPointy,r=e.width,n=this.toArray(),i=t?n.sort(function(e,t){return t.s-e.s||e.q-t.q}):n.sort(function(e,t){return e.q-t.q}),o=i[0];return i[i.length-1].x-o.x+r}},{key:"pixelHeight",get:function(){if(0===this.size)return 0;var e=this.hexPrototype,t=e.isPointy,r=e.height,n=this.toArray(),i=t?n.sort(function(e,t){return e.r-t.r}):n.sort(function(e,t){return t.s-e.s||e.r-t.r}),o=i[0];return i[i.length-1].y-o.y+r}},{key:n,value:function(){return u(this,ae).values()}},{key:"hexPrototype",get:function(){return u(this,oe).prototype}},{key:"createHex",value:function(e){return new(u(this,oe))(e)}},{key:"getHex",value:function(e){var t=this.createHex(e);return u(this,ae).get(t.toString())}},{key:"hasHex",value:function(e){return u(this,ae).has(e.toString())}},{key:"setHexes",value:function(e){var t,r=h(e);try{for(r.s();!(t=r.n()).done;){var n=t.value,i=n instanceof C?n:new(u(this,oe))(n);s(this,se,fe).call(this,i)}}catch(e){r.e(e)}finally{r.f()}return this}},{key:"filter",value:function(t){var r,n=new e(u(this,oe)),i=h(this);try{for(i.s();!(r=i.n()).done;){var o=r.value;t(o)&&s(n,se,fe).call(n,o)}}catch(e){i.e(e)}finally{i.f()}return n}},{key:"map",value:function(t){var r,n=new e(u(this,oe)),i=h(this);try{for(i.s();!(r=i.n()).done;){var o=r.value;s(n,se,fe).call(n,t(o))}}catch(e){i.e(e)}finally{i.f()}return n}},{key:"traverse",value:function(t){var r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.bail,o=void 0!==i&&i,a=new e(u(this,oe)),c=h(s(this,ce,ye).call(this,t));try{for(c.s();!(r=c.n()).done;){var l=r.value,f=this.getHex(l);if(f)s(a,se,fe).call(a,f);else if(o)return a}}catch(e){c.e(e)}finally{c.f()}return a}},{key:"forEach",value:function(e){var t,r=h(this);try{for(r.s();!(t=r.n()).done;)e(t.value)}catch(e){r.e(e)}finally{r.f()}return this}},{key:"reduce",value:function(e,t){if(void 0===t){var r,n,i,o,a=h(this);try{for(a.s();!(o=a.n()).done;){var s=o.value;n=i,i=s,n&&(r=e(n,i))}}catch(e){a.e(e)}finally{a.f()}return r}var c,u=t,l=h(this);try{for(l.s();!(c=l.n()).done;)u=e(u,c.value)}catch(e){l.e(e)}finally{l.f()}return u}},{key:"toArray",value:function(){return Array.from(this)}},{key:"toJSON",value:function(){var e=this.hexPrototype;return{hexSettings:{dimensions:e.dimensions,orientation:e.orientation,origin:e.origin,offset:e.offset},coordinates:this.toArray()}}},{key:"toString",value:function(){return"".concat(this.constructor.name,"(").concat(this.size,")")}},{key:"pointToHex",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.allowOutside,n=void 0===r||r,i=Y(this.hexPrototype,e),o=this.getHex(i);return n?null!=o?o:this.createHex(i):o}},{key:"distance",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.allowOutside,i=void 0===n||n;if(i)return _(this.hexPrototype,e,t);var o=this.getHex(e),a=this.getHex(t);return o&&a?_(this.hexPrototype,o,a):void 0}},{key:"neighborOf",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.allowOutside,i=void 0===n||n,o=X(this.createHex(e),t),a=this.getHex(o);return i?null!=a?a:o:a}}],[{key:"fromIterable",value:function(t){var r=t[Symbol.iterator]().next().value;if(!r)throw new TypeError("Can't create grid from empty iterable: ".concat(JSON.stringify(t)));return new e(r.constructor,t)}},{key:"fromJSON",value:function(t){var r=t.hexSettings,n=t.coordinates,i=W(r);return new e(i,n.map(function(e){return new i(e)}))}}]),e}();function fe(e){u(this,ae).set(e.toString(),e)}function ye(e){return s(this,ue,de).call(this,e)?s(this,le,ve).call(this,e):Array.isArray(e)&&s(this,ue,de).call(this,e[0])?s(this,le,ve).call(this,Z(e)):e}function de(e){return"function"==typeof e}function ve(e){return e(this.createHex.bind(this))}const ge=200,pe=-2*window.visualViewport.width,me=new he(W({dimensions:100,orientation:A.FLAT,origin:"topLeft"}),(we={width:15,height:6},function(e,t){var r,n=we.width,i=we.height,o=we.start,a=we.direction,s=void 0===a?V.E:a,c=null!==(r=null!=o?o:t)&&void 0!==r?r:[0,0],u=re(ee({start:c,direction:E(s,2),length:i}),ee({direction:s,length:n-1}))(e,c);return!o&&t?u.slice(1):u}));var we;const be=(()=>{const e=ge*(Math.sqrt(3)-1),t=ge*(2*Math.sqrt(2)-2),r=[{x:-2,y:0},{x:-1,y:0-Math.sqrt(3)},{x:1,y:0-Math.sqrt(3)},{x:2,y:0},{x:1,y:Math.sqrt(3)},{x:-1,y:Math.sqrt(3)}].map(e=>({x:e.x*ge/4+150,y:e.y*ge/4+150}));return{moveU:{src:"img/actions/moveU.png",polygon:r.map(r=>({x:r.x-e,y:r.y-t/2})),key:"u"},moveI:{src:"img/actions/moveI.png",polygon:r.map(e=>({x:e.x,y:e.y-t})),key:"i"},moveO:{src:"img/actions/moveO.png",polygon:r.map(r=>({x:r.x+e,y:r.y-t/2})),key:"o"},moveJ:{src:"img/actions/moveJ.png",polygon:r.map(r=>({x:r.x-e,y:r.y+t/2})),key:"j"},moveK:{src:"img/actions/moveK.png",polygon:r.map(e=>({x:e.x,y:e.y+t})),key:"k"},moveL:{src:"img/actions/moveL.png",polygon:r.map(r=>({x:r.x+e,y:r.y+t/2})),key:"l"}}})();function xe(){let e;Object.defineProperties(this,{player:{enumerable:!0,get:()=>e,set(t){if(!(t instanceof ke))throw new TypeError("Tile.player must be of type Player");e instanceof ke||(e=t)}}})}function Oe(_ref){let{col:e,row:t,scene:r,player:n}=_ref;const i=me.getHex({row:t,col:e}),o=r.add.image(i.x,i.y,"cities",n.frame).setDepth(2).setScale(.8);i.city=this,me.traverse(ie({start:[i.q,i.r],radius:1})).forEach(e=>{e.tile.claimTerritory(n)}),me.traverse(ie({start:[i.q,i.r],radius:2})).forEach(e=>{e.terrain.isWater&&!e.tile.player&&e.tile.claimTerritory(n)}),Object.defineProperties(this,{player:{enumerable:!0,get:()=>n},sprite:{get:()=>o}})}Object.assign(xe.prototype,{claimTerritory(e){this.player=e,qe.markTerritory()}}),Object.assign(Oe.prototype,{});const ke=(()=>{let e=null;function t(t){const r=[];Object.defineProperties(this,{frame:{enumerable:!0,get:()=>t%3},index:{enumerable:!0,get:()=>t},units:{enumerable:!0,get:()=>r},activeUnit:{enumerable:!0,get(){if(Number.isInteger(e)&&e>=0&&e<=r.length)return r[e]},set:t=>Number.isInteger(t)&&t>=0?t>=r.length?(e=t%r.length,!0):(e=t,!0):(null===t&&(e=null),!1)},color:{enumerable:!0,get(){switch(t%3){case 0:return 16711680;case 1:return 65280;case 2:return 255;default:return 11184810;}}}})}return Object.assign(t.prototype,{addUnit(e,t,r,n){this.units.push(new Te(e,{row:t,col:r,scene:n,player:this}))},checkEndTurn(){console.log("Sam, checkEndTurn"),this.activateNext()||qe.endTurn()},activateUnit(){let t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:e;if(0===this.units.length)return void this.checkEndTurn();const r=this.units[t];if(!(r instanceof Te))throw new TypeError(`Player does not have unit ${t}`);r.activate(),e=t},activateNext(){for(let t=e+1;t<this.units.length&&this.units[t]instanceof Te;t++)if(this.units[t].moves>0)return this.activateUnit(t),e=t,!0;for(let t=0;t<=e&&this.units[t]instanceof Te;t++)if(this.units[t].moves>0)return this.activateUnit(t),e=t,!0;return!1}}),t})(),qe={players:[new ke(0),new ke(1),new ke(2)],turn:0,activeUnit:null,currentPlayer:null,intCurrentPlayer:null,sprActiveUnit:null,startRound(){me.filter(e=>"object"==typeof e.city&&null!==e.city).forEach(e=>{const t=e.city;console.log("Sam, startRound, city:",t),me.traverse(ie({start:[e.q,e.r],radius:2}))}),this.turn++,console.log("Sam, startRound",this.turn),this.startTurn(0)},startTurn(e){if(!Number.isFinite(e))throw new TypeError(`Unknown player ${e}`);if(this.currentPlayer=this.players[e],!(this.currentPlayer instanceof ke))throw new TypeError(`Player ${e} is not a Player Object`);this.intCurrentPlayer=e,this.currentPlayer.units.forEach(e=>{e.moves=e.base.movementPoints}),this.markTerritory(),this.currentPlayer.activateUnit(0)},markTerritory(){const e=qe.scenes.getScene("mainGameScene").add.graphics({x:0,y:0}).setDepth(1);me.forEach(t=>{if(!(t.tile&&t.tile.player instanceof ke))return;e.lineStyle(5,t.tile.player.color),e.beginPath();const[r,...n]=t.corners.map(e=>function(e,t){let r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:.9;const n=(e.y-t.y)/(e.x-t.x),i=e.y-n*e.x,o=(e.x-t.x)*r+t.x;return{x:o,y:n*o+i}}(e,t,.97));e.moveTo(r.x,r.y),n.forEach(_ref2=>{let{x:t,y:r}=_ref2;e.lineTo(t,r)}),e.closePath(),e.strokePath()})},endTurn(){console.log("Sam, endTurn!"),this.intCurrentPlayer++,this.intCurrentPlayer>=this.players.length?this.endRound():this.startTurn(this.intCurrentPlayer)},endRound(){console.log("Sam, endRound!"),this.startRound()}};function Se(e,t,r){switch(e){case"moveU":case"u":r%2==0&&t--,r--;break;case"moveI":case"i":t--;break;case"moveO":case"o":r%2==0&&t--,r++;break;case"moveJ":case"j":r%2==1&&t++,r--;break;case"moveK":case"k":t++;break;case"moveL":case"l":r%2==1&&t++,r++;}return[t,r]}function Pe(){qe.sprActiveUnit.setActive(!1).setPosition(pe,pe).setDepth(0),Object.entries(be).forEach(_ref3=>{let[e,t]=_ref3;t.img.setActive(!1).setPosition(pe,pe).setDepth(0)})}function Te(e,_ref4){let{row:t,col:r,scene:n,player:i}=_ref4;const o=json.world.units[e];if("object"!=typeof o||null===o)throw new TypeError(`Unknown unit '${e}'`);const{x:a,y:s}=me.getHex({row:t,col:r}),c=n.add.sprite(a,s,`unit.${e}`);this.col=r,this.row=t,Object.defineProperties(this,{base:{enumerable:!0,get:()=>o},player:{enumerable:!0,get:()=>i},scene:{enumerable:!0,get:()=>n},sprite:{enumerable:!0,get:()=>c},unitType:{enumerable:!0,get:()=>e}})}function je(e){return qe.currentPlayer===qe.players[0]&&!e.repeat&&"object"==typeof qe.activeUnit&&null!==qe.activeUnit&&void qe.activeUnit.doAction(e.key)}function Ee(e,t,r){const n=me.getHex({row:t,col:r});if(void 0===n)return!1;if(n.city instanceof Oe&&n.city.player.index!==e.player.index&&(!e.attack||!e.attackCities))return!1;const i=e.base.movementCosts[n.terrain.terrain];return!!Number.isFinite(i)&&i<=e.moves}Object.assign(Te.prototype,{activate(){const{x:e,y:t}=me.getHex({row:this.row,col:this.col});this.scene.cameras.main.centerOn(e,t),this.sprite.setDepth(100),qe.sprActiveUnit.setActive(!0).setPosition(e,t).setDepth(99),Object.entries(be).forEach(_ref5=>{let[r,n]=_ref5;const[i,o]=Se(r,this.row,this.col);Ee(this,i,o)?n.img.setActive(!0).setPosition(e,t).setDepth(98):n.img.setActive(!1).setPosition(pe,pe).setDepth(0)}),qe.activeUnit=this,this.scene.input.keyboard.enabled=!0},deactivate(){Pe(),this.sprite.setDepth(3),qe.activeUnit=null,this.scene.input.keyboard.enabled=!1,qe.currentPlayer.checkEndTurn()},doAction(e){if("w"!==e&&"Tab"!==e){if(" "===e)return this.moves=0,void this.deactivate();if(["moveU","u","moveI","i","moveO","o","moveJ","j","moveK","k","moveL","l"].includes(e)){const[t,r]=Se(e,this.row,this.col);if(!Ee(this,t,r))return;this.row=t,this.col=r;const n=me.getHex({row:this.row,col:this.col});return this.sprite.setPosition(n.x,n.y).setDepth(3),this.moves-=this.base.movementCosts[n.terrain.terrain],void(this.moves>0?this.player.activateUnit():this.deactivate())}if("b"===e&&"settler"===this.unitType){const e=me.getHex({col:this.col,row:this.row});if(e.terrain.isWater)return;if(me.traverse(ie({start:[e.q,e.r],radius:1})).filter(e=>"object"==typeof e.city&&null!==e.city).size>0)return;new Oe({col:this.col,row:this.row,player:this.player,scene:this.scene});const t=this.player.units.indexOf(this);return t>=0&&this.player.units.splice(t,1),this.deactivate(),void this.sprite.setActive(!1).setPosition(pe,pe).setDepth(0)}if("c"===e){const e=me.getHex({row:this.row,col:this.col});if(e.tile.player===this.player)return;return e.tile.claimTerritory(this.player),this.moves--,void this.deactivate()}}else this.deactivate()}});const Ne=.5,Re={type:Phaser.AUTO,height:window.visualViewport.height/Ne,width:window.visualViewport.width/Ne,zoom:Ne,backgroundColor:"#71ABFF",scene:{key:"mainGameScene",preload(){Object.entries(json.world.terrains).forEach(_ref6=>{let[e,t]=_ref6;this.load.image(`tile.${e}`,`img/tiles/${t.tile}.png`)}),this.load.spritesheet("cities","img/tiles/cities.png",{frameHeight:200,frameWidth:200}),this.load.image("activeUnit","img/activeUnit.png"),Object.entries(be).forEach(_ref7=>{let[e,t]=_ref7;this.load.image(e,t.src)}),Object.keys(json.world.units).forEach(e=>{this.load.image(`unit.${e}`,`img/units/${e}.png`)})},create(){me.forEach(e=>{const t=json.world.world[e.row][e.col];Object.assign(e,t,{tile:new xe,terrain:{...json.world.terrains[t.terrain],terrain:t.terrain},sprite:this.add.image(e.x,e.y,`tile.${t.terrain}`).setDepth(0),text:this.add.text(e.x-100,e.y+ge/3.6,e.row+"\xD7"+e.col,{fixedWidth:ge,font:"12pt Trebuchet MS",align:"center",color:"white"}).setOrigin(0)})}).forEach(e=>{"object"==typeof e.city&&null!==e.city&&(e.city=new Oe({col:e.col,row:e.row,scene:this,player:qe.players[e.city.player]}))}),qe.sprActiveUnit=this.add.image(pe,pe,"activeUnit").setActive(!1),Object.entries(be).forEach(_ref8=>{let[e,t]=_ref8;t.img=this.add.image(pe,pe,e).setInteractive(new Phaser.Geom.Polygon(t.polygon),Phaser.Geom.Polygon.Contains).on("pointerdown",()=>{console.log("Sam, pointerdown on",e),je({key:e})}).setActive(!1)}),qe.players[0].addUnit("settler",2,3,this),qe.players[0].addUnit("warrior",2,3,this),console.log("Sam, players:",qe.players),console.log("Sam, unit 1:",qe.players[0].units[0]),this.input.keyboard.on("keydown",e=>{e.ctrlKey&&["r","1","2","3","4","5","6","7","8","9"].includes(e.key)||(e.preventDefault(),je(e))}).enabled=!1,qe.startRound(),this.events.on("pause",()=>{console.log("Sam, mainGameScene paused"),Pe()}),this.events.on("resume",()=>{console.log("Sam, mainGameScene resumed"),qe.scenes.wake("mainControls"),qe.currentPlayer.activateUnit()})},update(){}}};yodasws.page("pageGame").setRoute({template:"pages/game/game.html",canonicalRoute:"/game/",route:"/game/?"}).on("load",()=>{const e=new Phaser.Game(Object.assign({},Re,{parent:document.querySelector("main")}));e.scene.sleep("mainGameScene"),e.scene.add("mainControls",{preload(){},create(){console.log("Sam, mainControls created");const e=this.add.graphics({x:0,y:0});e.lineStyle(5,255),e.beginPath(),e.moveTo(1e3,0),e.lineTo(1e3,1e3),e.lineTo(0,1e3),e.closePath(),e.strokePath(),e.fillStyle(65280),e.fillCircle(window.visualViewport.width/Ne/2,window.visualViewport.height/Ne-150,150),this.events.on("sleep",()=>{console.log("Sam, mainControls sleep")})},update(){}},!0),e.scene.moveAbove("mainGameScene","mainControls"),e.scene.add("city-view",{preload(){},create(){},update(){}}),e.scene.sleep("city-view"),setTimeout(()=>{e.scene.pause("mainGameScene"),setTimeout(()=>{e.scene.switch("mainControls","city-view"),setTimeout(()=>{e.scene.resume("mainGameScene")},1e3)},1e3)},1e3),e.scene.add("main-menu",{preload(){},create(){},update(){}}),e.scene.sleep("main-menu"),e.scene.add("tech-tree",{preload(){},create(){},update(){}}),e.scene.sleep("tech-tree"),qe.scenes=e.scene,console.log("Sam, scenes:",e.scene.scenes)})},746:e=>{"use strict";e.exports=JSON.parse("{\"terrains\":{\"ocean\":{\"isWater\":true,\"tile\":\"ocean\"},\"lake\":{\"isWater\":true,\"tile\":\"lake\"},\"grass\":{\"tile\":\"grass\"},\"desert\":{\"tile\":\"desert\"},\"mountain\":{\"tile\":\"mountains\"},\"hill\":{\"tile\":\"grass\"}},\"units\":{\"settler\":{\"movementPoints\":1,\"movementCosts\":{\"ocean\":false,\"grass\":1,\"desert\":1,\"mountain\":false,\"lake\":1,\"hill\":1}},\"warrior\":{\"movementPoints\":1,\"movementCosts\":{\"ocean\":false,\"grass\":1,\"desert\":1,\"mountain\":1,\"hill\":1}}},\"world\":[[{\"terrain\":\"ocean\"},{\"terrain\":\"ocean\"},{\"terrain\":\"ocean\"},{\"terrain\":\"ocean\"},{\"terrain\":\"ocean\"},{\"terrain\":\"ocean\"},{\"terrain\":\"ocean\"},{\"terrain\":\"ocean\"},{\"terrain\":\"ocean\"},{\"terrain\":\"ocean\"},{\"terrain\":\"ocean\"},{\"terrain\":\"ocean\"},{\"terrain\":\"ocean\"},{\"terrain\":\"ocean\"},{\"terrain\":\"ocean\"}],[{\"terrain\":\"grass\"},{\"terrain\":\"grass\",\"river\":true},{\"terrain\":\"lake\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"lake\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"}],[{\"terrain\":\"desert\"},{\"terrain\":\"desert\",\"river\":true},{\"terrain\":\"desert\"},{\"terrain\":\"hill\",\"city\":{\"player\":0}},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\",\"city\":{\"player\":2}},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"}],[{\"terrain\":\"hill\"},{\"terrain\":\"mountain\"},{\"terrain\":\"hill\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\",\"city\":{\"player\":1}},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"}],[{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"}],[{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"}]]}")}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var o=t[n]={exports:{}};return e[n](o,o.exports,r),o.exports}r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},window.json={},r(601),json.world=r(746),yodasws.page("home").setRoute({template:"pages/home.html",route:"/"}).on("load",()=>{})})();