"use strict";(()=>{var t={601:(t,e,r)=>{"use strict";var n;function i(t,e){a(t,e),e.add(t)}function o(t,e,r){a(t,e),e.set(t,r)}function a(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function s(t,e,r){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return r}function u(t,e,r){return function(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}(t,l(t,e,"set"),r),r}function c(t,e){return function(t,e){return e.get?e.get.call(t):e.value}(t,l(t,e,"get"))}function l(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function h(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=x(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function f(t,e){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},f(t,e)}function y(t,e){if(e&&("object"===q(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function v(t){return v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},v(t)}function g(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function d(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?g(Object(r),!0).forEach(function(e){b(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function p(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function m(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function w(t,e,r){return e&&m(t.prototype,e),r&&m(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function b(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function x(t,e){if(t){if("string"==typeof t)return O(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?O(t,e):void 0}}function O(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function q(t){return q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},q(t)}r.r(e);var k=function(t){return Number.isFinite(t)&&!Number.isNaN(t)},P=function(t){return"object"==q(t)&&null!==t},S=function(t){return P(t)&&k(t.col)&&k(t.row)},j=function(t){return Array.isArray(t)&&k(t[0])&&k(t[1])},E=function(t,e){return e+t*(1&e)>>1},T=function(t,e){return function(t,e){return(t%8+8)%8}(t+e)},N=function(t){var e,r,n=(r=3,function(t){if(Array.isArray(t))return t}(e=t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,o=[],a=!0,s=!1;try{for(r=r.call(t);!(a=(n=r.next()).done)&&(o.push(n.value),!e||o.length!==e);a=!0);}catch(t){s=!0,i=t}finally{try{a||null==r.return||r.return()}finally{if(s)throw i}}return o}}(e,r)||x(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=n[0],o=n[1],a=n[2];return{q:i,r:o,s:void 0===a?-i-o:a}};function R(t){var e=t.q,r=t.r,n=t.s,i=k(e),o=k(r),a=k(n);if(i&&o&&a)return{q:e,r,s:n};if(i&&o)return{q:e,r,s:-e-r};if(i&&a)return{q:e,r:-e-n,s:n};if(o&&a)return{q:-r-n,r,s:n};throw new TypeError("Can't determine three cube coordinates from less than two coordinates. Received: { q: ".concat(e,", r: ").concat(r,", s: ").concat(n," }."))}var A=function(t){return t.FLAT="FLAT",t.POINTY="POINTY",t}(A||{});var M=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0];p(this,t),b(this,"q",void 0),b(this,"r",void 0);var r=K(this,e),n=r.q,i=r.r;this.q=n,this.r=i}return w(t,[{key:"center",get:function(){var t=this.width,e=this.height;return{x:t/2-this.x,y:e/2-this.y}}},{key:"col",get:function(){return W(this).col}},{key:"corners",get:function(){var t=this.orientation,e=this.width,r=this.height,n=this.x,i=this.y;return t===A.POINTY?U(e,r,n,i):C(e,r,n,i)}},{key:"dimensions",get:function(){return I.dimensions}},{key:"height",get:function(){var t=this.orientation,e=this.dimensions.yRadius;return t===A.POINTY?2*e:e*Math.sqrt(3)}},{key:"isFlat",get:function(){return this.orientation===A.FLAT}},{key:"isPointy",get:function(){return this.orientation===A.POINTY}},{key:"orientation",get:function(){return I.orientation}},{key:"origin",get:function(){return I.origin}},{key:"offset",get:function(){return I.offset}},{key:"row",get:function(){return W(this).row}},{key:"width",get:function(){var t=this.orientation,e=this.dimensions.xRadius;return t===A.POINTY?e*Math.sqrt(3):2*e}},{key:"x",get:function(){return D(this).x}},{key:"y",get:function(){return D(this).y}},{key:"s",get:function(){return-this.q-this.r}},{key:"clone",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this;return new this.constructor(t)}},{key:"equals",value:function(t){return function(t,e){if(S(t)&&S(e))return t.col===e.col&&t.row===e.row;if(Object.hasOwn(t,"col")||Object.hasOwn(e,"col"))throw new Error("Can't compare coordinates where one are offset coordinates. Either pass two offset coordinates or two axial/cube coordinates. Received: ".concat(JSON.stringify(t)," and ").concat(JSON.stringify(e)));var r=j(t)?N(t):t,n=j(e)?N(e):e;return r.q===n.q&&r.r===n.r}(this,S(t)?Y(this,t):t)}},{key:"toString",value:function(){return"".concat(this.constructor.name,"(").concat(this.q,",").concat(this.r,")")}},{key:"translate",value:function(t){return _(this,t)}}],[{key:"settings",get:function(){var t=this.prototype;return{dimensions:t.dimensions,orientation:t.orientation,origin:t.origin,offset:t.offset}}}]),t}(),I={dimensions:{xRadius:1,yRadius:1},orientation:A.POINTY,origin:{x:0,y:0},offset:-1},U=function(t,e,r,n){return[{x:r+.5*t,y:n-.25*e},{x:r+.5*t,y:n+.25*e},{x:r,y:n+.5*e},{x:r-.5*t,y:n+.25*e},{x:r-.5*t,y:n-.25*e},{x:r,y:n-.5*e}]},C=function(t,e,r,n){return[{x:r+.25*t,y:n-.5*e},{x:r+.5*t,y:n},{x:r+.25*t,y:n+.5*e},{x:r-.25*t,y:n+.5*e},{x:r-.5*t,y:n},{x:r-.25*t,y:n-.5*e}]};function H(t){var e=d(d({},I),t),r=e.dimensions,n=e.orientation,i=e.origin,o=e.offset;return function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&f(t,e)}(u,t);var e,a,s=(e=u,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,r=v(e);if(a){var n=v(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return y(this,t)});function u(){return p(this,u),s.apply(this,arguments)}return w(u,[{key:"dimensions",get:function(){return function(t,e){if(P(t)&&t.xRadius>0&&t.yRadius>0)return t;if(P(t)&&t.width>0&&t.height>0){var r=t.width,n=t.height;return e===A.POINTY?{xRadius:r/Math.sqrt(3),yRadius:n/2}:{xRadius:r/2,yRadius:n/Math.sqrt(3)}}if(t>0)return{xRadius:t,yRadius:t};throw new TypeError("Invalid dimensions: ".concat(JSON.stringify(t),". Dimensions must be expressed as an Ellipse ({ xRadius: number, yRadius: number }), a Rectangle ({ width: number, height: number }) or a number."))}(r,n)}},{key:"orientation",get:function(){return n}},{key:"origin",get:function(){return function(t,e){if(function(t){return P(t)&&k(t.x)&&k(t.y)}(t))return t;if(!e)throw new TypeError("Supply a bounding box ({ width: number, height: number }). Received: ".concat(JSON.stringify(e)));if("topLeft"===t)return{x:-.5*e.width,y:-.5*e.height};throw new TypeError("Invalid origin: ".concat(JSON.stringify(t),". Origin must be expressed as a Point ({ x: number, y: number }) or the string 'topLeft'."))}(i,this)}},{key:"offset",get:function(){return o}}]),u}(M)}var W=function(t){var e=t.q,r=t.r,n=t.offset;return t.isPointy?function(t,e,r){return{col:t+E(r,e),row:e}}(e,r,n):function(t,e,r){return{col:t,row:e+E(r,t)}}(e,r,n)},D=function(t){var e=t.orientation,r=t.dimensions,n=r.xRadius,i=r.yRadius,o=t.origin,a=o.x,s=o.y,u=t.q,c=t.r;return e===A.POINTY?{x:n*Math.sqrt(3)*(u+c/2)-a,y:3*i/2*c-s}:{x:3*n/2*u-a,y:i*Math.sqrt(3)*(c+u/2)-s}},L=function(t,e,r){var n=t-E(r,e);return{q:n,r:e,s:-n-e}},J=function(t,e,r){var n=t,i=e-E(r,t);return{q:n,r:i,s:-n-i}},Y=function(t,e){var r=t.offset,n=t.orientation,i=e.col,o=e.row;return n===A.POINTY?L(i,o,r):J(i,o,r)},$=function(t){var e=R(t),r=e.q,n=e.r,i=e.s,o=Math.round(r),a=Math.round(n),s=Math.round(i),u=Math.abs(r-o),c=Math.abs(n-a),l=Math.abs(i-s);return u>c&&u>l?o=-a-s:c>l?a=-o-s:s=-o-a,{q:o,r:a,s}},F=function(t,e){var r=t.dimensions,n=r.xRadius,i=r.yRadius,o=t.origin,a=t.orientation,s=e.x,u=e.y;return s+=o.x,u+=o.y,a===A.POINTY?$({q:Math.sqrt(3)*s/(3*n)-u/(3*i),r:2/3*(u/i)}):$({q:2/3*(s/n),r:Math.sqrt(3)*u/(3*i)-s/(3*n)})};function K(t,e){return j(e)?N(e):S(e)?Y(t,e):R(e)}function _(t,e){var r=R(t),n=r.q,i=r.r,o=r.s,a=R(e),s={q:n+a.q,r:i+a.r,s:o+a.s};return t instanceof M?t.clone(s):s}function z(t,e,r){var n=K(t,e),i=n.q,o=n.r,a=n.s,s=K(t,r),u=s.q,c=s.r,l=s.s;return Math.max(Math.abs(i-u),Math.abs(o-c),Math.abs(a-l))}var G=function(t){return t.CLOCKWISE="CLOCKWISE",t.COUNTERCLOCKWISE="COUNTERCLOCKWISE",t}(G||{}),B=function(t){return t[t.N=0]="N",t[t.NE=1]="NE",t[t.E=2]="E",t[t.SE=3]="SE",t[t.S=4]="S",t[t.SW=5]="SW",t[t.W=6]="W",t[t.NW=7]="NW",t}(B||{}),V=[null,{q:1,r:-1},{q:1,r:0},{q:0,r:1},null,{q:-1,r:1},{q:-1,r:0},{q:0,r:-1}],Q=[{q:0,r:-1},{q:1,r:-1},null,{q:1,r:0},{q:0,r:1},{q:-1,r:1},null,{q:-1,r:0}],X=function(t,e){return t.clone(t.isPointy?function(t,e){var r=t.offset,n=t.q,i=t.r,o=t.col,a=t.row;if(e===B.S||e===B.N){var s=e===B.S?a+1:a-1;return L(o,s,r)}var u=V[e];return{q:n+u.q,r:i+u.r}}(t,e):function(t,e){var r=t.offset,n=t.q,i=t.r,o=t.col,a=t.row;if(e===B.E||e===B.W){var s=e===B.E?o+1:o-1;return J(s,a,r)}var u=Q[e];return{q:n+u.q,r:i+u.r}}(t,e))};function Z(t){return Array.isArray(t)?function(e,r){var n,i=[],o=r,a=h(t);try{for(a.s();!(n=a.n()).done;){var s,u=h((0,n.value)(e,o));try{for(u.s();!(s=u.n()).done;){var c=s.value;i.push(o=c)}}catch(t){u.e(t)}finally{u.f()}}}catch(t){a.e(t)}finally{a.f()}return i}:t}function tt(t){return function(t){return t.direction in B}(t)?function(t){var e=t.start,r=t.direction,n=t.length;return function(t,i){var o=[],a=t(null!=e?e:i);!e&&i&&(a=X(a,r));for(var s=0;s<n;s++)o.push(a),a=X(a,r);return o}}(t):function(t){var e=t.start,r=t.stop;return function(t,n){for(var i=[],o=t(null!=e?e:n),a=function(t,e){return function(r){return{q:t.q*(1-r)+e.q*r,r:t.r*(1-r)+e.r*r}}}(et(o),et(K(o,r))),s=z(o,o,r),u=1/Math.max(s,1),c=!e&&n?1:0;c<=s;c++){var l=$(a(u*c));i.push(t(l))}return i}}(t)}function et(t){return{q:t.q+1e-6,r:t.r+1e-6,s:t.s+-2e-6}}function rt(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.includeSource,i=void 0===n||n;return function(r,n){var o,a=[],s=h(Z(t)(r,n));try{for(s.s();!(o=s.n()).done;){var u=o.value;i&&a.push(u);var c,l=h(Z(e)(r,u));try{for(l.s();!(c=l.n()).done;){var f=c.value;a.push(f)}}catch(t){l.e(t)}finally{l.f()}}}catch(t){s.e(t)}finally{s.f()}return a}}B.E,B.N,B.S,B.W;var nt=[{q:1,r:0},{q:0,r:1},{q:-1,r:1},{q:-1,r:0},{q:0,r:-1},{q:1,r:-1}];function it(t){var e=t.radius,r=t.start,n=t.rotation;return function(t,i){var o,a=null!==(o=null!=r?r:i)&&void 0!==o?o:[0,0],s=!r&&i?e:e+1;return rt(tt({start:r,direction:B.N,length:s}),function(t){var e=t.center,r=t.rotation,n=void 0===r?G.CLOCKWISE:r;return function(r,i){var o,a,s=n.toUpperCase(),u=[],c=t.radius;k(c)?a=r(e).translate({q:c,s:-c}):c=z(a=r(null!==(o=t.start)&&void 0!==o?o:i),e,a);var l=K(a,e),h=r({q:l.q,r:l.r-c,s:l.s+c});if(s===G.CLOCKWISE)for(var f=0;f<6;f++)for(var y=0;y<c;y++){var v=nt[f],g=v.q,d=v.r;h=r({q:h.q+g,r:h.r+d}),u.push(h)}else for(var p=5;p>=0;p--)for(var m=0;m<c;m++){var w=nt[p],b=w.q,x=w.r;h=r({q:h.q-b,r:h.r-x}),u.push(h)}var O=!t.start&&i,q=u.findIndex(function(t){return t.equals(a)});return u.slice(q+(O?1:0)).concat(u.slice(0,q))}}({center:a,rotation:n}))(t,i)}}var ot=new WeakMap,at=new WeakMap,st=new WeakSet,ut=new WeakSet,ct=new WeakSet,lt=new WeakSet;n=Symbol.iterator;var ht=function(){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(p(this,t),i(this,lt),i(this,ct),i(this,ut),i(this,st),o(this,ot,{writable:!0,value:void 0}),o(this,at,{writable:!0,value:new Map}),e instanceof t)return u(this,ot,c(e,ot)),void this.setHexes(e);u(this,ot,e),this.setHexes(s(this,ut,yt).call(this,r))}return w(t,[{key:"size",get:function(){return c(this,at).size}},{key:"pixelWidth",get:function(){if(0===this.size)return 0;var t=this.hexPrototype,e=t.isPointy,r=t.width,n=this.toArray(),i=e?n.sort(function(t,e){return e.s-t.s||t.q-e.q}):n.sort(function(t,e){return t.q-e.q}),o=i[0];return i[i.length-1].x-o.x+r}},{key:"pixelHeight",get:function(){if(0===this.size)return 0;var t=this.hexPrototype,e=t.isPointy,r=t.height,n=this.toArray(),i=e?n.sort(function(t,e){return t.r-e.r}):n.sort(function(t,e){return e.s-t.s||t.r-e.r}),o=i[0];return i[i.length-1].y-o.y+r}},{key:n,value:function(){return c(this,at).values()}},{key:"hexPrototype",get:function(){return c(this,ot).prototype}},{key:"createHex",value:function(t){return new(c(this,ot))(t)}},{key:"getHex",value:function(t){var e=this.createHex(t);return c(this,at).get(e.toString())}},{key:"hasHex",value:function(t){return c(this,at).has(t.toString())}},{key:"setHexes",value:function(t){var e,r=h(t);try{for(r.s();!(e=r.n()).done;){var n=e.value,i=n instanceof M?n:new(c(this,ot))(n);s(this,st,ft).call(this,i)}}catch(t){r.e(t)}finally{r.f()}return this}},{key:"filter",value:function(e){var r,n=new t(c(this,ot)),i=h(this);try{for(i.s();!(r=i.n()).done;){var o=r.value;e(o)&&s(n,st,ft).call(n,o)}}catch(t){i.e(t)}finally{i.f()}return n}},{key:"map",value:function(e){var r,n=new t(c(this,ot)),i=h(this);try{for(i.s();!(r=i.n()).done;){var o=r.value;s(n,st,ft).call(n,e(o))}}catch(t){i.e(t)}finally{i.f()}return n}},{key:"traverse",value:function(e){var r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.bail,o=void 0!==i&&i,a=new t(c(this,ot)),u=h(s(this,ut,yt).call(this,e));try{for(u.s();!(r=u.n()).done;){var l=r.value,f=this.getHex(l);if(f)s(a,st,ft).call(a,f);else if(o)return a}}catch(t){u.e(t)}finally{u.f()}return a}},{key:"forEach",value:function(t){var e,r=h(this);try{for(r.s();!(e=r.n()).done;)t(e.value)}catch(t){r.e(t)}finally{r.f()}return this}},{key:"reduce",value:function(t,e){if(void 0===e){var r,n,i,o,a=h(this);try{for(a.s();!(o=a.n()).done;){var s=o.value;n=i,i=s,n&&(r=t(n,i))}}catch(t){a.e(t)}finally{a.f()}return r}var u,c=e,l=h(this);try{for(l.s();!(u=l.n()).done;)c=t(c,u.value)}catch(t){l.e(t)}finally{l.f()}return c}},{key:"toArray",value:function(){return Array.from(this)}},{key:"toJSON",value:function(){var t=this.hexPrototype;return{hexSettings:{dimensions:t.dimensions,orientation:t.orientation,origin:t.origin,offset:t.offset},coordinates:this.toArray()}}},{key:"toString",value:function(){return"".concat(this.constructor.name,"(").concat(this.size,")")}},{key:"pointToHex",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.allowOutside,n=void 0===r||r,i=F(this.hexPrototype,t),o=this.getHex(i);return n?null!=o?o:this.createHex(i):o}},{key:"distance",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.allowOutside,i=void 0===n||n;if(i)return z(this.hexPrototype,t,e);var o=this.getHex(t),a=this.getHex(e);return o&&a?z(this.hexPrototype,o,a):void 0}},{key:"neighborOf",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.allowOutside,i=void 0===n||n,o=X(this.createHex(t),e),a=this.getHex(o);return i?null!=a?a:o:a}}],[{key:"fromIterable",value:function(e){var r=e[Symbol.iterator]().next().value;if(!r)throw new TypeError("Can't create grid from empty iterable: ".concat(JSON.stringify(e)));return new t(r.constructor,e)}},{key:"fromJSON",value:function(e){var r=e.hexSettings,n=e.coordinates,i=H(r);return new t(i,n.map(function(t){return new i(t)}))}}]),t}();function ft(t){c(this,at).set(t.toString(),t)}function yt(t){return s(this,ct,vt).call(this,t)?s(this,lt,gt).call(this,t):Array.isArray(t)&&s(this,ct,vt).call(this,t[0])?s(this,lt,gt).call(this,Z(t)):t}function vt(t){return"function"==typeof t}function gt(t){return t(this.createHex.bind(this))}const dt=200,pt=-2*window.visualViewport.width,mt=new ht(H({dimensions:100,orientation:A.FLAT,origin:"topLeft"}),(wt={width:15,height:6},function(t,e){var r,n=wt.width,i=wt.height,o=wt.start,a=wt.direction,s=void 0===a?B.E:a,u=null!==(r=null!=o?o:e)&&void 0!==r?r:[0,0],c=rt(tt({start:u,direction:T(s,2),length:i}),tt({direction:s,length:n-1}))(t,u);return!o&&e?c.slice(1):c}));var wt;const bt=(()=>{const t=dt*(Math.sqrt(3)-1),e=dt*(2*Math.sqrt(2)-2),r=[{x:-2,y:0},{x:-1,y:0-Math.sqrt(3)},{x:1,y:0-Math.sqrt(3)},{x:2,y:0},{x:1,y:Math.sqrt(3)},{x:-1,y:Math.sqrt(3)}].map(t=>({x:t.x*dt/4+150,y:t.y*dt/4+150}));return{moveU:{src:"img/actions/moveU.png",polygon:r.map(r=>({x:r.x-t,y:r.y-e/2})),key:"u"},moveI:{src:"img/actions/moveI.png",polygon:r.map(t=>({x:t.x,y:t.y-e})),key:"i"},moveO:{src:"img/actions/moveO.png",polygon:r.map(r=>({x:r.x+t,y:r.y-e/2})),key:"o"},moveJ:{src:"img/actions/moveJ.png",polygon:r.map(r=>({x:r.x-t,y:r.y+e/2})),key:"j"},moveK:{src:"img/actions/moveK.png",polygon:r.map(t=>({x:t.x,y:t.y+e})),key:"k"},moveL:{src:"img/actions/moveL.png",polygon:r.map(r=>({x:r.x+t,y:r.y+e/2})),key:"l"}}})();function xt(){this.player=void 0,Object.defineProperties(this,{})}function Ot(_ref){let{col:t,row:e,scene:r,player:n}=_ref;const i=mt.getHex({row:e,col:t}),o=r.add.image(i.x,i.y,"cities",n%3).setDepth(1).setScale(.8);i.city=this,Object.defineProperties(this,{sprite:{get:()=>o}})}Object.assign(xt.prototype,{claimTerritory(t){"object"==typeof this.player&&null!==this.player||(this.player=t)}}),Object.assign(Ot.prototype,{});const qt=(()=>{let t=null;function e(){const e=[];Object.defineProperties(this,{units:{enumerable:!0,get:()=>e},activeUnit:{enumerable:!0,get(){if(Number.isInteger(t)&&t>=0&&t<=e.length)return e[t]},set:r=>Number.isInteger(r)&&r>=0?r>=e.length?(t=r%e.length,!0):(t=r,!0):(null===r&&(t=null),!1)}})}return Object.assign(e.prototype,{addUnit(t,e,r,n){this.units.push(new St(t,{row:e,col:r,scene:n,player:this}))},checkEndTurn(){console.log("Sam, checkEndTurn"),this.activateNext()||kt.endTurn()},activateUnit(){let e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:t;const r=this.units[e];if(!(r instanceof St))throw new TypeError(`Player does not have unit ${e}`);r.activate(),t=e},activateNext(){for(let e=t+1;e<this.units.length&&this.units[e]instanceof St;e++)if(this.units[e].moves>0)return this.activateUnit(e),t=e,!0;for(let e=0;e<=t&&this.units[e]instanceof St;e++)if(this.units[e].moves>0)return this.activateUnit(e),t=e,!0;return!1}}),e})(),kt={players:[new qt],turn:0,activeUnit:null,currentPlayer:null,intCurrentPlayer:null,sprActiveUnit:null,startRound(){mt.filter(t=>"object"==typeof t.city&&null!==t.city).forEach(t=>{const e=t.city;console.log("Sam, startRound, city:",e),mt.traverse(it({start:[t.q,t.r],radius:2}))}),this.turn++,console.log("Sam, startRound",this.turn),this.startTurn(0)},startTurn(t){if(!Number.isFinite(t))throw new TypeError(`Unknown player ${t}`);if(this.currentPlayer=this.players[t],!(this.currentPlayer instanceof qt))throw new TypeError(`Player ${t} is not a Player Object`);this.intCurrentPlayer=t,this.currentPlayer.units.forEach(t=>{t.moves=t.base.movementPoints}),this.currentPlayer.activateUnit(0)},endTurn(){console.log("Sam, endTurn!"),this.intCurrentPlayer++,this.intCurrentPlayer>=this.players.length?this.endRound():this.startTurn(this.intCurrentPlayer)},endRound(){console.log("Sam, endRound!"),this.startRound()}};function Pt(t,e,r){switch(t){case"moveU":case"u":r%2==0&&e--,r--;break;case"moveI":case"i":e--;break;case"moveO":case"o":r%2==0&&e--,r++;break;case"moveJ":case"j":r%2==1&&e++,r--;break;case"moveK":case"k":e++;break;case"moveL":case"l":r%2==1&&e++,r++;}return[e,r]}function St(t,_ref2){let{row:e,col:r,scene:n,player:i}=_ref2;const o=json.world.units[t];if("object"!=typeof o||null===o)throw new TypeError(`Unknown unit '${t}'`);const{x:a,y:s}=mt.getHex({row:e,col:r}),u=n.add.sprite(a,s,`unit.${t}`);this.col=r,this.row=e,Object.defineProperties(this,{base:{enumerable:!0,get:()=>o},player:{enumerable:!0,get:()=>i},scene:{enumerable:!0,get:()=>n},sprite:{enumerable:!0,get:()=>u},unitType:{enumerable:!0,get:()=>t}})}function jt(t){return kt.currentPlayer===kt.players[0]&&!t.repeat&&"object"==typeof kt.activeUnit&&null!==kt.activeUnit&&void kt.activeUnit.doAction(t.key)}function Et(t,e,r){const n=mt.getHex({row:e,col:r});if(void 0===n)return!1;n.city;const i=t.base.movementCosts[n.terrain];return!!Number.isFinite(i)&&i<=t.moves}Object.assign(St.prototype,{activate(){const{x:t,y:e}=mt.getHex({row:this.row,col:this.col});this.scene.cameras.main.centerOn(t,e),this.sprite.setDepth(100),kt.sprActiveUnit.setActive(!0).setPosition(t,e).setDepth(99),Object.entries(bt).forEach(_ref3=>{let[r,n]=_ref3;const[i,o]=Pt(r,this.row,this.col);Et(this,i,o)?n.img.setActive(!0).setPosition(t,e).setDepth(98):n.img.setActive(!1).setPosition(pt,pt).setDepth(0)}),kt.activeUnit=this,this.scene.input.keyboard.enabled=!0},deactivate(){kt.sprActiveUnit.setActive(!1).setPosition(pt,pt).setDepth(0),Object.entries(bt).forEach(_ref4=>{let[t,e]=_ref4;e.img.setActive(!1).setPosition(pt,pt).setDepth(0)}),this.sprite.setDepth(2),kt.activeUnit=null,this.scene.input.keyboard.enabled=!1,kt.currentPlayer.checkEndTurn()},doAction(t){if("w"!==t&&"Tab"!==t){if(" "===t)return this.moves=0,void this.deactivate();if(["moveU","u","moveI","i","moveO","o","moveJ","j","moveK","k","moveL","l"].includes(t)){const[e,r]=Pt(t,this.row,this.col);if(!Et(this,e,r))return;this.row=e,this.col=r;const n=mt.getHex({row:this.row,col:this.col});return this.sprite.setPosition(n.x,n.y).setDepth(2),this.moves-=this.base.movementCosts[n.terrain],void(this.moves>0?this.player.activateUnit():this.deactivate())}if("b"===t&&"settler"===this.unitType){const t=mt.getHex({col:this.col,row:this.row});if(mt.traverse(it({start:[t.q,t.r],radius:1})).filter(t=>"object"==typeof t.city&&null!==t.city).size>0)return;new Ot({col:this.col,row:this.row,player:this.player,scene:this.scene});const e=this.player.units.indexOf(this);return console.log("Sam, splice",e),e>=0&&this.player.units.splice(e,1),this.deactivate(),void this.sprite.setActive(!1).setPosition(pt,pt).setDepth(0)}"c"===t&&(mt.getHex({row:this.row,col:this.col}).tile.claimTerritory(this.player),this.moves--,this.deactivate())}else this.deactivate()}});const Tt={type:Phaser.AUTO,height:window.visualViewport.height/.5,width:window.visualViewport.width/.5,zoom:.5,backgroundColor:"#71ABFF",scene:{preload(){Object.entries(json.world.terrains).forEach(_ref5=>{let[t,e]=_ref5;this.load.image(`tile.${t}`,`img/tiles/${e.tile}.png`)}),this.load.spritesheet("cities","img/tiles/cities.png",{frameHeight:200,frameWidth:200}),this.load.image("activeUnit","img/activeUnit.png"),Object.entries(bt).forEach(_ref6=>{let[t,e]=_ref6;this.load.image(t,e.src)}),Object.keys(json.world.units).forEach(t=>{this.load.image(`unit.${t}`,`img/units/${t}.png`)})},create(){mt.forEach(t=>{const e=json.world.world[t.row][t.col];Object.assign(t,e,{tile:new xt({col:t.col,row:t.row}),sprite:this.add.image(t.x,t.y,`tile.${e.terrain}`).setDepth(0),text:this.add.text(t.x-100,t.y+dt/3.6,t.row+"\xD7"+t.col,{fixedWidth:dt,font:"12pt Trebuchet MS",align:"center",color:"white"}).setOrigin(0)}),"object"==typeof t.city&&null!==t.city&&new Ot({col:t.col,row:t.row,scene:this,player:t.city.player})}),kt.sprActiveUnit=this.add.image(pt,pt,"activeUnit").setActive(!1),Object.entries(bt).forEach(_ref7=>{let[t,e]=_ref7;e.img=this.add.image(pt,pt,t).setInteractive(new Phaser.Geom.Polygon(e.polygon),Phaser.Geom.Polygon.Contains).on("pointerdown",()=>{console.log("Sam, pointerdown on",t),jt({key:t})}).setActive(!1)}),kt.players[0].addUnit("settler",1,2,this),kt.players[0].addUnit("warrior",Math.floor(2*Math.random()+1),Math.floor(3*Math.random()),this),console.log("Sam, players:",kt.players),console.log("Sam, unit 1:",kt.players[0].units[0]),this.input.keyboard.on("keydown",t=>{t.preventDefault(),jt(t)}).enabled=!1,kt.startRound()},update(){}}};yodasws.page("pageGame").setRoute({template:"pages/game/game.html",canonicalRoute:"/game/",route:"/game/?"}).on("load",()=>{new Phaser.Game(Object.assign({},Tt,{parent:document.querySelector("main")}))})},746:t=>{"use strict";t.exports=JSON.parse("{\"terrains\":{\"ocean\":{\"tile\":\"ocean\"},\"lake\":{\"tile\":\"lake\"},\"grass\":{\"tile\":\"grass\"},\"desert\":{\"tile\":\"desert\"},\"mountain\":{\"tile\":\"mountains\"},\"hill\":{\"tile\":\"grass\"}},\"units\":{\"settler\":{\"movementPoints\":1,\"movementCosts\":{\"ocean\":false,\"grass\":1,\"desert\":1,\"mountain\":false,\"hill\":1}},\"warrior\":{\"movementPoints\":1,\"movementCosts\":{\"ocean\":false,\"grass\":1,\"desert\":1,\"mountain\":1,\"hill\":1}}},\"world\":[[{\"terrain\":\"ocean\"},{\"terrain\":\"ocean\"},{\"terrain\":\"ocean\"},{\"terrain\":\"ocean\"},{\"terrain\":\"ocean\"},{\"terrain\":\"ocean\"},{\"terrain\":\"ocean\"},{\"terrain\":\"ocean\"},{\"terrain\":\"ocean\"},{\"terrain\":\"ocean\"},{\"terrain\":\"ocean\"},{\"terrain\":\"ocean\"},{\"terrain\":\"ocean\"},{\"terrain\":\"ocean\"},{\"terrain\":\"ocean\"}],[{\"terrain\":\"grass\",\"city\":{\"player\":2}},{\"terrain\":\"grass\",\"river\":true},{\"terrain\":\"grass\",\"city\":{\"player\":0}},{\"terrain\":\"lake\"},{\"terrain\":\"grass\",\"city\":{\"player\":1}},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"}],[{\"terrain\":\"desert\"},{\"terrain\":\"desert\",\"river\":true},{\"terrain\":\"desert\"},{\"terrain\":\"hill\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"}],[{\"terrain\":\"hill\"},{\"terrain\":\"mountain\"},{\"terrain\":\"hill\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"}],[{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"}],[{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"}]]}")}},e={};function r(n){var i=e[n];if(void 0!==i)return i.exports;var o=e[n]={exports:{}};return t[n](o,o.exports,r),o.exports}r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},window.json={},r(601),json.world=r(746),yodasws.page("home").setRoute({template:"pages/home.html",route:"/"}).on("load",()=>{})})();