"use strict";(()=>{var e={907:()=>{yodasws.page("pageBlog").setRoute({title:"Blog",canonicalRoute:"/blog/",template(e,...t){const n=t.join("/").replace(/\/+/g,"/").replace(/^\/|\/$/g,"").split("/").filter(e=>""!=e);return 0===n.length?"pages/blog/index.html":{canonicalRoute:"/blog/"+n.join("/")+"/",template:"pages/blog/"+n.join(".")+".html"}},route:"/blog(/.*)*"}).on("load",()=>{})}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}(()=>{"use strict";function e(e,n,r){t(e,n),n.set(e,r)}function t(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function r(e,t,n){return e.set(o(e,t),n),n}function i(e,t){return e.get(o(e,t))}function o(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}function a(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=m(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function s(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(s=function(){return!!e})()}function u(e){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},u(e)}function c(e,t){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},c(e,t)}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach(function(t){v(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,d(r.key),r)}}function p(e,t,n){return t&&y(e.prototype,t),n&&y(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function v(e,t,n){return(t=d(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e){var t=function(e){if("object"!=g(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=g(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==g(t)?t:t+""}function m(e,t){if(e){if("string"==typeof e)return b(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?b(e,t):void 0}}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function g(e){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},g(e)}n(907);var w=function(e){return Number.isFinite(e)&&!Number.isNaN(e)},x=function(e){return"object"==g(e)&&null!==e},O=function(e){return x(e)&&w(e.col)&&w(e.row)},k=function(e){return Array.isArray(e)&&w(e[0])&&w(e[1])},S=function(e,t){return t+e*(1&t)>>1},T=function(e,t){return function(e){return(e%8+8)%8}(e+t)},P=function(e){var t=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],u=!0,c=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){c=!0,i=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw i}}return s}}(e,t)||m(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(e,3),n=t[0],r=t[1],i=t[2];return{q:n,r,s:void 0===i?-n-r:i}};function j(e){var t=e.q,n=e.r,r=e.s,i=w(t),o=w(n),a=w(r);if(i&&o&&a)return{q:t,r:n,s:r};if(i&&o)return{q:t,r:n,s:-t-n};if(i&&a)return{q:t,r:-t-r,s:r};if(o&&a)return{q:-n-r,r:n,s:r};throw new TypeError("Can't determine three cube coordinates from less than two coordinates. Received: { q: ".concat(t,", r: ").concat(n,", s: ").concat(r," }."))}var E=function(e){return e.FLAT="FLAT",e.POINTY="POINTY",e}(E||{});var C=function(){return p(function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0];h(this,e),v(this,"q",void 0),v(this,"r",void 0);var n=U(this,t),r=n.q,i=n.r;this.q=r,this.r=i},[{key:"center",get:function(){var e=this.width,t=this.height;return{x:e/2-this.x,y:t/2-this.y}}},{key:"col",get:function(){return L(this).col}},{key:"corners",get:function(){var e=this.orientation,t=this.width,n=this.height,r=this.x,i=this.y;return e===E.POINTY?A(t,n,r,i):I(t,n,r,i)}},{key:"dimensions",get:function(){return M.dimensions}},{key:"height",get:function(){var e=this.orientation,t=this.dimensions.yRadius;return e===E.POINTY?2*t:t*Math.sqrt(3)}},{key:"isFlat",get:function(){return this.orientation===E.FLAT}},{key:"isPointy",get:function(){return this.orientation===E.POINTY}},{key:"orientation",get:function(){return M.orientation}},{key:"origin",get:function(){return M.origin}},{key:"offset",get:function(){return M.offset}},{key:"row",get:function(){return L(this).row}},{key:"width",get:function(){var e=this.orientation,t=this.dimensions.xRadius;return e===E.POINTY?t*Math.sqrt(3):2*t}},{key:"x",get:function(){return W(this).x}},{key:"y",get:function(){return W(this).y}},{key:"s",get:function(){return-this.q-this.r}},{key:"clone",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this;return new this.constructor(e)}},{key:"equals",value:function(e){return function(e,t){if(O(e)&&O(t))return e.col===t.col&&e.row===t.row;if(Object.hasOwn(e,"col")||Object.hasOwn(t,"col"))throw new Error("Can't compare coordinates where one are offset coordinates. Either pass two offset coordinates or two axial/cube coordinates. Received: ".concat(JSON.stringify(e)," and ").concat(JSON.stringify(t)));var n=k(e)?P(e):e,r=k(t)?P(t):t;return n.q===r.q&&n.r===r.r}(this,O(e)?_(this,e):e)}},{key:"toString",value:function(){return"".concat(this.constructor.name,"(").concat(this.q,",").concat(this.r,")")}},{key:"translate",value:function(e){return function(e,t){var n=j(e),r=n.q,i=n.r,o=n.s,a=j(t),s={q:r+a.q,r:i+a.r,s:o+a.s};return e instanceof C?e.clone(s):s}(this,e)}}],[{key:"settings",get:function(){var e=this.prototype;return{dimensions:e.dimensions,orientation:e.orientation,origin:e.origin,offset:e.offset}}}])}(),M={dimensions:{xRadius:1,yRadius:1},orientation:E.POINTY,origin:{x:0,y:0},offset:-1},A=function(e,t,n,r){return[{x:n+.5*e,y:r-.25*t},{x:n+.5*e,y:r+.25*t},{x:n,y:r+.5*t},{x:n-.5*e,y:r+.25*t},{x:n-.5*e,y:r-.25*t},{x:n,y:r-.5*t}]},I=function(e,t,n,r){return[{x:n+.25*e,y:r-.5*t},{x:n+.5*e,y:r},{x:n+.25*e,y:r+.5*t},{x:n-.25*e,y:r+.5*t},{x:n-.5*e,y:r},{x:n-.25*e,y:r-.5*t}]};function q(e){var t=f(f({},M),e),n=t.dimensions,r=t.orientation,i=t.origin,o=t.offset;return function(e){function t(){return h(this,t),function(e,t,n){return t=u(t),function(e,t){if(t&&("object"==g(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,s()?Reflect.construct(t,n||[],u(e).constructor):t.apply(e,n))}(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(t,e),p(t,[{key:"dimensions",get:function(){return function(e,t){if(x(e)&&e.xRadius>0&&e.yRadius>0)return e;if(x(e)&&e.width>0&&e.height>0){var n=e.width,r=e.height;return t===E.POINTY?{xRadius:n/Math.sqrt(3),yRadius:r/2}:{xRadius:n/2,yRadius:r/Math.sqrt(3)}}if(e>0)return{xRadius:e,yRadius:e};throw new TypeError("Invalid dimensions: ".concat(JSON.stringify(e),". Dimensions must be expressed as an Ellipse ({ xRadius: number, yRadius: number }), a Rectangle ({ width: number, height: number }) or a number."))}(n,r)}},{key:"orientation",get:function(){return r}},{key:"origin",get:function(){return function(e,t){if(function(e){return x(e)&&w(e.x)&&w(e.y)}(e))return e;if(!t)throw new TypeError("Supply a bounding box ({ width: number, height: number }). Received: ".concat(JSON.stringify(t)));if("topLeft"===e)return{x:-.5*t.width,y:-.5*t.height};throw new TypeError("Invalid origin: ".concat(JSON.stringify(e),". Origin must be expressed as a Point ({ x: number, y: number }) or the string 'topLeft'."))}(i,this)}},{key:"offset",get:function(){return o}}])}(C)}var L=function(e){var t=e.q,n=e.r,r=e.offset;return e.isPointy?function(e,t,n){return{col:e+S(n,t),row:t}}(t,n,r):function(e,t,n){return{col:e,row:t+S(n,e)}}(t,n,r)},W=function(e){var t=e.orientation,n=e.dimensions,r=n.xRadius,i=n.yRadius,o=e.origin,a=o.x,s=o.y,u=e.q,c=e.r;return t===E.POINTY?{x:r*Math.sqrt(3)*(u+c/2)-a,y:3*i/2*c-s}:{x:3*r/2*u-a,y:i*Math.sqrt(3)*(c+u/2)-s}},N=function(e,t,n){var r=e-S(n,t);return{q:r,r:t,s:-r-t}},D=function(e,t,n){var r=e,i=t-S(n,e);return{q:r,r:i,s:-r-i}},_=function(e,t){var n=e.offset,r=e.orientation,i=t.col,o=t.row;return r===E.POINTY?N(i,o,n):D(i,o,n)},R=function(e){var t=j(e),n=t.q,r=t.r,i=t.s,o=Math.round(n),a=Math.round(r),s=Math.round(i),u=Math.abs(n-o),c=Math.abs(r-a),l=Math.abs(i-s);return u>c&&u>l?o=-a-s:c>l?a=-o-s:s=-o-a,{q:o,r:a,s}};function U(e,t){return k(t)?P(t):O(t)?_(e,t):j(t)}function F(e,t,n){var r=U(e,t),i=r.q,o=r.r,a=r.s,s=U(e,n),u=s.q,c=s.r,l=s.s;return Math.max(Math.abs(i-u),Math.abs(o-c),Math.abs(a-l))}var H=function(e){return e.CLOCKWISE="CLOCKWISE",e.COUNTERCLOCKWISE="COUNTERCLOCKWISE",e}(H||{}),G=function(e){return e[e.N=0]="N",e[e.NE=1]="NE",e[e.E=2]="E",e[e.SE=3]="SE",e[e.S=4]="S",e[e.SW=5]="SW",e[e.W=6]="W",e[e.NW=7]="NW",e}(G||{}),V=[null,{q:1,r:-1},{q:1,r:0},{q:0,r:1},null,{q:-1,r:1},{q:-1,r:0},{q:0,r:-1}],z=[{q:0,r:-1},{q:1,r:-1},null,{q:1,r:0},{q:0,r:1},{q:-1,r:1},null,{q:-1,r:0}],K=function(e,t){return e.clone(e.isPointy?function(e,t){var n=e.offset,r=e.q,i=e.r,o=e.col,a=e.row;if(t===G.S||t===G.N){var s=t===G.S?a+1:a-1;return N(o,s,n)}var u=V[t];return{q:r+u.q,r:i+u.r}}(e,t):function(e,t){var n=e.offset,r=e.q,i=e.r,o=e.col,a=e.row;if(t===G.E||t===G.W){var s=t===G.E?o+1:o-1;return D(s,a,n)}var u=z[t];return{q:r+u.q,r:i+u.r}}(e,t))};function B(e){return Array.isArray(e)?function(t,n){var r,i=[],o=n,s=a(e);try{for(s.s();!(r=s.n()).done;){var u,c=a((0,r.value)(t,o));try{for(c.s();!(u=c.n()).done;){var l=u.value;i.push(o=l)}}catch(e){c.e(e)}finally{c.f()}}}catch(e){s.e(e)}finally{s.f()}return i}:e}function Y(e){return function(e){return e.direction in G}(e)?function(e){var t=e.start,n=e.direction,r=e.length;return function(e,i){var o=[],a=e(null!=t?t:i);!t&&i&&(a=K(a,n));for(var s=0;s<r;s++)o.push(a),a=K(a,n);return o}}(e):function(e){var t=e.start,n=e.stop;return function(e,r){for(var i=[],o=e(null!=t?t:r),a=function(e,t){return function(n){return{q:e.q*(1-n)+t.q*n,r:e.r*(1-n)+t.r*n}}}(J(o),J(U(o,n))),s=F(o,o,n),u=1/Math.max(s,1),c=!t&&r?1:0;c<=s;c++){var l=R(a(u*c));i.push(e(l))}return i}}(e)}function J(e){return{q:e.q+1e-6,r:e.r+1e-6,s:e.s+-2e-6}}function X(e,t){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).includeSource,r=void 0===n||n;return function(n,i){var o,s=[],u=a(B(e)(n,i));try{for(u.s();!(o=u.n()).done;){var c=o.value;r&&s.push(c);var l,f=a(B(t)(n,c));try{for(f.s();!(l=f.n()).done;){var h=l.value;s.push(h)}}catch(e){f.e(e)}finally{f.f()}}}catch(e){u.e(e)}finally{u.f()}return s}}G.E,G.N,G.S,G.W;function $(e){var t=e.center,n=e.rotation,r=void 0===n?H.CLOCKWISE:n;return function(n,i){var o,a,s=r.toUpperCase(),u=[],c=e.radius,l=w(c);l?a=n(t).translate({q:c,s:-c}):c=F(a=n(null!==(o=e.start)&&void 0!==o?o:i),t,a);var f=U(a,t),h=n({q:f.q,r:f.r-c,s:f.s+c});if(s===H.CLOCKWISE)for(var y=0;y<6;y++)for(var p=0;p<c;p++){var v=Q[y],d=v.q,m=v.r;h=n({q:h.q+d,r:h.r+m}),u.push(h)}else for(var b=5;b>=0;b--)for(var g=0;g<c;g++){var x=Q[b],O=x.q,k=x.r;h=n({q:h.q-O,r:h.r-k}),u.push(h)}var S=!l&&!e.start&&i,T=u.findIndex(function(e){return e.equals(a)});return u.slice(T+(S?1:0)).concat(u.slice(0,T))}}var Q=[{q:1,r:0},{q:0,r:1},{q:-1,r:1},{q:-1,r:0},{q:0,r:-1},{q:1,r:-1}];function Z(e){var t=e.radius,n=e.start,r=e.rotation;return function(e,i){var o,a=null!==(o=null!=n?n:i)&&void 0!==o?o:[0,0],s=!n&&i?t:t+1;return X(Y({start:n,direction:G.N,length:s}),$({center:a,rotation:r}))(e,i)}}var ee=new WeakMap,te=new WeakMap,ne=new WeakSet,re=function(){function n(a){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(h(this,n),function(e,n){t(e,n),n.add(e)}(this,ne),e(this,ee,void 0),e(this,te,new Map),a instanceof n)return r(ee,this,i(ee,a)),void this.setHexes(a);r(ee,this,a),this.setHexes(o(ne,this,oe).call(this,s))}return p(n,[{key:"size",get:function(){return i(te,this).size}},{key:"pixelWidth",get:function(){if(0===this.size)return 0;var e=this.hexPrototype,t=e.isPointy,n=e.width,r=this.toArray(),i=t?r.sort(function(e,t){return t.s-e.s||e.q-t.q}):r.sort(function(e,t){return e.q-t.q}),o=i[0];return i[i.length-1].x-o.x+n}},{key:"pixelHeight",get:function(){if(0===this.size)return 0;var e=this.hexPrototype,t=e.isPointy,n=e.height,r=this.toArray(),i=t?r.sort(function(e,t){return e.r-t.r}):r.sort(function(e,t){return t.s-e.s||e.r-t.r}),o=i[0];return i[i.length-1].y-o.y+n}},{key:Symbol.iterator,value:function(){return i(te,this).values()}},{key:"hexPrototype",get:function(){return i(ee,this).prototype}},{key:"createHex",value:function(e){return new(i(ee,this))(e)}},{key:"getHex",value:function(e){var t=this.createHex(e);return i(te,this).get(t.toString())}},{key:"hasHex",value:function(e){return i(te,this).has(e.toString())}},{key:"setHexes",value:function(e){var t,n=a(e);try{for(n.s();!(t=n.n()).done;){var r=t.value,s=r instanceof C?r:new(i(ee,this))(r);o(ne,this,ie).call(this,s)}}catch(e){n.e(e)}finally{n.f()}return this}},{key:"filter",value:function(e){var t,r=new n(i(ee,this)),s=a(this);try{for(s.s();!(t=s.n()).done;){var u=t.value;e(u)&&o(ne,r,ie).call(r,u)}}catch(e){s.e(e)}finally{s.f()}return r}},{key:"map",value:function(e){var t,r=new n(i(ee,this)),s=a(this);try{for(s.s();!(t=s.n()).done;){var u=t.value;o(ne,r,ie).call(r,e(u))}}catch(e){s.e(e)}finally{s.f()}return r}},{key:"traverse",value:function(e){var t,r=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).bail,s=void 0!==r&&r,u=new n(i(ee,this)),c=a(o(ne,this,oe).call(this,e));try{for(c.s();!(t=c.n()).done;){var l=t.value,f=this.getHex(l);if(f)o(ne,u,ie).call(u,f);else if(s)return u}}catch(e){c.e(e)}finally{c.f()}return u}},{key:"forEach",value:function(e){var t,n=a(this);try{for(n.s();!(t=n.n()).done;)e(t.value)}catch(e){n.e(e)}finally{n.f()}return this}},{key:"reduce",value:function(e,t){if(void 0===t){var n,r,i,o,s=a(this);try{for(s.s();!(o=s.n()).done;){var u=o.value;r=i,i=u,r&&(n=e(r,i))}}catch(e){s.e(e)}finally{s.f()}return n}var c,l=t,f=a(this);try{for(f.s();!(c=f.n()).done;)l=e(l,c.value)}catch(e){f.e(e)}finally{f.f()}return l}},{key:"toArray",value:function(){return Array.from(this)}},{key:"toJSON",value:function(){var e=this.hexPrototype;return{hexSettings:{dimensions:e.dimensions,orientation:e.orientation,origin:e.origin,offset:e.offset},coordinates:this.toArray()}}},{key:"toString",value:function(){return"".concat(this.constructor.name,"(").concat(this.size,")")}},{key:"pointToHex",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).allowOutside,n=void 0===t||t,r=function(e,t){var n=e.dimensions,r=n.xRadius,i=n.yRadius,o=e.origin,a=e.orientation,s=t.x,u=t.y;return s+=o.x,u+=o.y,a===E.POINTY?R({q:Math.sqrt(3)*s/(3*r)-u/(3*i),r:2/3*(u/i)}):R({q:2/3*(s/r),r:Math.sqrt(3)*u/(3*i)-s/(3*r)})}(this.hexPrototype,e),i=this.getHex(r);return n?null!=i?i:this.createHex(r):i}},{key:"distance",value:function(e,t){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).allowOutside;if(void 0===n||n)return F(this.hexPrototype,e,t);var r=this.getHex(e),i=this.getHex(t);return r&&i?F(this.hexPrototype,r,i):void 0}},{key:"neighborOf",value:function(e,t){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).allowOutside,r=void 0===n||n,i=K(this.createHex(e),t),o=this.getHex(i);return r?null!=o?o:i:o}}],[{key:"fromIterable",value:function(e){var t=e[Symbol.iterator]().next().value;if(!t)throw new TypeError("Can't create grid from empty iterable: ".concat(JSON.stringify(e)));return new n(t.constructor,e)}},{key:"fromJSON",value:function(e,t){var r=e.hexSettings,i=e.coordinates;if(t){var o=i.map(t);return new n(o.length>0?o[0].constructor:t({q:0,r:0},0,[{q:0,r:0}]).constructor,o)}var a=q(r);return new n(a,i.map(function(e){return new a(e)}))}}])}();function ie(e){i(te,this).set(e.toString(),e)}function oe(e){return o(ne,this,ae).call(this,e)?o(ne,this,se).call(this,e):Array.isArray(e)&&o(ne,this,ae).call(this,e[0])?o(ne,this,se).call(this,B(e)):e}function ae(e){return"function"==typeof e}function se(e){return e(this.createHex.bind(this))}var ue=200;void 0===globalThis.window&&(globalThis.window={visualViewport:{height:1080,width:1920}});var ce=function(){return{height:window.visualViewport.height/.5,width:window.visualViewport.width/.5,offscreen:-2*Math.max(window.visualViewport.width,window.visualViewport.height)}};const le=JSON.parse("{\"actions\":[{\"key\":\"move\",\"label\":\"Move here\",\"description\":\"Move to target location\",\"icon\":\"move-to-tile.png\",\"showIn\":[\"tile-menu\"],\"isValid\":\"isLegalMove\",\"execute\":\"startMoveTo\"},{\"key\":\"wait\",\"label\":\"Wait\",\"description\":\"Wait and come back later this turn\",\"icon\":\"wait.png\",\"showIn\":[\"unit-actions-menu\"],\"isValid\":true,\"execute\":\"wait\"},{\"key\":\"skip\",\"label\":\"Skip\",\"description\":\"Skip this unit's turn\",\"icon\":\"skip.png\",\"showIn\":[\"unit-actions-menu\"],\"isValid\":true,\"execute\":\"skip\"},{\"key\":\"tile\",\"label\":\"Information on space\",\"description\":\"View information about this tile\",\"icon\":\"about-tile.png\",\"showIn\":[\"tile-menu\"],\"isValid\":\"hexTileValid\",\"execute\":\"startTileView\"},{\"key\":\"city-view\",\"label\":\"View City\",\"description\":\"View information about this city\",\"icon\":\"city-view.png\",\"showIn\":[\"tile-menu\"],\"isValid\":\"isCityTile\",\"execute\":\"startCityView\"},{\"key\":\"build-farm\",\"label\":\"Build Farm\",\"description\":\"Construct a farm on this tile. The farmer unit will be consumed and become a laborer to work the farm.\",\"icon\":\"farm.png\",\"unitTypes\":[\"farmer\"],\"showIn\":[\"unit-actions-menu\"],\"isValid\":\"isFarmBuildable\",\"execute\":\"buildFarm\"},{\"key\":\"end-turn\",\"label\":\"End Turn\",\"description\":\"End Turn\",\"icon\":\"end-turn.png\",\"showIn\":[\"unit-actions-menu\"],\"isValid\":\"currentPlayerTurn\",\"execute\":\"endTurn\"}],\"improvements\":{\"farm\":{\"title\":\"Subsistence Farm\",\"tile\":\"farm\",\"housing\":1,\"terrains\":{\"grass\":{\"food\":2,\"turns\":1},\"moor\":{\"food\":1,\"turns\":1},\"swamp\":{\"food\":2,\"turns\":6}}}},\"FactionNames\":[\"Publius Helvius Pertinax\",\"Gaius Flavius Agricola\",\"Brigantes\",\"Catuvellauni\",\"Trinovantes\",\"Dobunni\",\"Cornovii\",\"Atrebates\"],\"NationNames\":[\"Roman Empire\"],\"StandardMovable\":{\"crossCreeks\":1.25,\"crossStreams\":1.5,\"moveOnLand\":true,\"moveOnWater\":false,\"movementPoints\":12,\"movementCosts\":{\"canal\":12,\"stream\":12,\"river\":24,\"desert\":12,\"grass\":12,\"hill\":18,\"marsh\":18,\"moor\":12,\"mountain\":24,\"oceans\":12,\"swamp\":24}},\"ResourceTransporter\":{\"crossCreeks\":1.25,\"crossStreams\":2,\"moveOnLand\":true,\"moveOnWater\":false,\"movementPoints\":12,\"movementCosts\":{\"canal\":3,\"stream\":6,\"river\":3,\"desert\":12,\"grass\":12,\"hill\":18,\"marsh\":18,\"moor\":12,\"mountain\":24,\"oceans\":12,\"swamp\":24}},\"goods\":{\"food\":{\"tile\":\"wheat\"}},\"terrains\":{\"desert\":{\"name\":\"Desert\",\"movementCost\":12,\"food\":0,\"tile\":\"desert\"},\"grass\":{\"name\":\"Grassland\",\"movementCost\":12,\"food\":1,\"tile\":\"grass\"},\"hill\":{\"name\":\"Hill\",\"movementCost\":12,\"food\":1,\"tile\":\"grass\"},\"lake\":{\"name\":\"Lake\",\"movementCost\":12,\"food\":1,\"isWater\":true,\"tile\":\"lake\"},\"marsh\":{\"name\":\"Marsh\",\"movementCost\":12,\"food\":0,\"isWater\":true,\"tile\":\"swamp\"},\"moor\":{\"name\":\"Moor\",\"movementCost\":12,\"food\":0,\"tile\":\"mountains\"},\"mountain\":{\"name\":\"Mountain\",\"movementCost\":12,\"food\":0,\"tile\":\"mountains\"},\"ocean\":{\"name\":\"Ocean\",\"movementCost\":12,\"food\":1,\"isWater\":true,\"tile\":\"ocean\"},\"swamp\":{\"name\":\"Swamp\",\"movementCost\":12,\"food\":0,\"isWater\":true,\"tile\":\"swamp\"}},\"units\":{\"builder\":{\"name\":\"Builder\",\"defense\":0,\"moveOnWater\":false,\"movementPoints\":12,\"movementCosts\":{\"desert\":12,\"grass\":12,\"hill\":12,\"moor\":12,\"mountain\":24,\"swamp\":24}},\"farmer\":{\"name\":\"Farmer\",\"defense\":0,\"moveOnWater\":false,\"movementPoints\":12,\"movementCosts\":{\"desert\":12,\"grass\":12,\"hill\":12,\"moor\":12,\"mountain\":24,\"swamp\":24}},\"miner\":{\"name\":\"Miner\",\"defense\":0,\"moveOnWater\":false,\"movementPoints\":12,\"movementCosts\":{\"desert\":12,\"grass\":12,\"hill\":12,\"moor\":12,\"mountain\":24,\"swamp\":24}},\"rancher\":{\"name\":\"Rancher\",\"defense\":0,\"moveOnWater\":false,\"movementPoints\":12,\"movementCosts\":{\"desert\":12,\"grass\":12,\"hill\":12,\"moor\":12,\"mountain\":24,\"swamp\":24}},\"settler\":{\"name\":\"Settler\",\"defense\":0,\"moveOnWater\":false,\"movementPoints\":12,\"movementCosts\":{\"desert\":12,\"grass\":12,\"hill\":12,\"moor\":12,\"mountain\":24,\"swamp\":24}},\"warrior\":{\"name\":\"Warrior\",\"attack\":1,\"attackCities\":true,\"defense\":1,\"moveOnWater\":false,\"movementPoints\":12,\"movementCosts\":{\"desert\":12,\"grass\":12,\"hill\":12,\"moor\":12,\"mountain\":24,\"swamp\":24}}},\"world\":[[{\"terrain\":\"ocean\"},{\"terrain\":\"ocean\"},{\"terrain\":\"ocean\"},{\"terrain\":\"ocean\"},{\"terrain\":\"ocean\"},{\"terrain\":\"ocean\"},{\"terrain\":\"ocean\"},{\"terrain\":\"ocean\"},{\"terrain\":\"ocean\"},{\"terrain\":\"ocean\"},{\"terrain\":\"ocean\"},{\"terrain\":\"ocean\"},{\"terrain\":\"ocean\"},{\"terrain\":\"ocean\"},{\"terrain\":\"ocean\"}],[{\"terrain\":\"grass\"},{\"terrain\":\"swamp\",\"river\":true},{\"terrain\":\"lake\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"lake\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"}],[{\"terrain\":\"desert\"},{\"terrain\":\"desert\",\"river\":true},{\"terrain\":\"desert\"},{\"terrain\":\"grass\",\"city\":{\"nation\":0}},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"mountain\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"}],[{\"terrain\":\"grass\"},{\"terrain\":\"mountain\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"mountain\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"}],[{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"mountain\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"}],[{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"mountain\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"},{\"terrain\":\"grass\"}]]}");function fe(e){return fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fe(e)}function he(){he=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,r){var o=t&&t.prototype instanceof m?t:m,a=Object.create(o.prototype),s=new M(r||[]);return i(a,"_invoke",{value:P(e,n,s)}),a}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var h="suspendedStart",y="suspendedYield",p="executing",v="completed",d={};function m(){}function b(){}function g(){}var w={};c(w,a,function(){return this});var x=Object.getPrototypeOf,O=x&&x(x(A([])));O&&O!==n&&r.call(O,a)&&(w=O);var k=g.prototype=m.prototype=Object.create(w);function S(e){["next","throw","return"].forEach(function(t){c(e,t,function(e){return this._invoke(t,e)})})}function T(e,t){function n(i,o,a,s){var u=f(e[i],e,o);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==fe(l)&&r.call(l,"__await")?t.resolve(l.__await).then(function(e){n("next",e,a,s)},function(e){n("throw",e,a,s)}):t.resolve(l).then(function(e){c.value=e,a(c)},function(e){return n("throw",e,a,s)})}s(u.arg)}var o;i(this,"_invoke",{value:function(e,r){function i(){return new t(function(t,i){n(e,r,t,i)})}return o=o?o.then(i,i):i()}})}function P(t,n,r){var i=h;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===v){if("throw"===o)throw a;return{value:e,done:!0}}for(r.method=o,r.arg=a;;){var s=r.delegate;if(s){var u=j(s,r);if(u){if(u===d)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===h)throw i=v,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var c=f(t,n,r);if("normal"===c.type){if(i=r.done?v:y,c.arg===d)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=v,r.method="throw",r.arg=c.arg)}}}function j(t,n){var r=n.method,i=t.iterator[r];if(i===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,j(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var o=f(i,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,d;var a=o.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,d):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,d)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function M(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function A(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(fe(t)+" is not iterable")}return b.prototype=g,i(k,"constructor",{value:g,configurable:!0}),i(g,"constructor",{value:b,configurable:!0}),b.displayName=c(g,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,c(e,u,"GeneratorFunction")),e.prototype=Object.create(k),e},t.awrap=function(e){return{__await:e}},S(T.prototype),c(T.prototype,s,function(){return this}),t.AsyncIterator=T,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new T(l(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then(function(e){return e.done?e.value:a.next()})},S(k),c(k,u,"Generator"),c(k,a,function(){return this}),c(k,"toString",function(){return"[object Generator]"}),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=A,M.prototype={constructor:M,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(C),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(r,i){return s.type="throw",s.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),C(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;C(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:A(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),d}},t}var ye=he().mark(Le);function pe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function ve(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pe(Object(n),!0).forEach(function(t){de(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pe(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function de(e,t,n){return(t=be(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function me(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,be(r.key),r)}}function be(e){var t=function(e){if("object"!=fe(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=fe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==fe(t)?t:t+""}function ge(e,t,n){we(e,t),t.set(e,n)}function we(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xe(e,t){return e.get(ke(e,t))}function Oe(e,t,n){return e.set(ke(e,t),n),n}function ke(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}function Se(e,t,n,r){if(!vn(e))throw new TypeError("FindPath expects a Hex as start!");if(!vn(t))throw new TypeError("FindPath expects a Hex as end!");if(!qe.isInstanceofMovable(n))throw new TypeError("FindPath expects a Movable!");var i=[],o=[],a=!1;e.parent=void 0,i.push(e),e.g_cost=0;for(var s=function(){var e=i.sort(function(e,t){return e.f_cost-t.f_cost||e.h_cost-t.h_cost})[0];if(e===t)return a=!0,1;i=i.filter(function(t){return e!==t}),o.push(e),r.traverse($({center:[e.q,e.r],radius:1})).forEach(function(a){o.includes(a)||bn(a,n)&&(a.g_cost=e.g_cost+gn(n,a,e),a.h_cost=r.distance(e,t),a.f_cost=a.g_cost+a.h_cost,i.includes(a)||(a.parent=e,i.push(a)))})};i.length>0&&!s(););if(!a)return[];var u=[t],c=t;do{var l;(c=c.parent)!==e&&u.unshift(c)}while(vn(null===(l=c)||void 0===l?void 0:l.parent));return u}var Te=new WeakMap,Pe=new WeakMap,je=new WeakMap,Ee=new WeakMap,Ce=new WeakMap,Me=new WeakMap,Ae=new WeakMap,Ie=new WeakSet,qe=function(){function e(t){var n=t.base,r=void 0===n?{}:n,i=t.hex,o=t.faction;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),function(e,t){we(e,t),t.add(e)}(this,Ie),ge(this,Te,le.StandardMovable),ge(this,Pe,!1),ge(this,je,void 0),ge(this,Ee,void 0),ge(this,Ce,null),ge(this,Me,0),ge(this,Ae,[]),!vn(i))throw new TypeError("Movable expects to be assigned a Hex!");Oe(je,this,wt.isFaction(o)?o:i.tile.faction),Oe(Ee,this,i),Oe(Te,this,ve(ve(ve({},xe(Te,this)),r),{},{movementCosts:ve(ve({},xe(Te,this).movementCosts),r.movementCosts)}))}return t=e,n=[{key:"baseMovementPoints",get:function(){return xe(Te,this).movementPoints}},{key:"deleted",get:function(){return xe(Pe,this)},set:function(e){Oe(Pe,this,!!e)}},{key:"faction",get:function(){return xe(je,this)}},{key:"canContinueOnPath",get:function(){return null!==xe(Ce,this)&&xe(Ae,this).length>0&&xe(Me,this)>0}},{key:"hex",get:function(){return xe(Ee,this)}},{key:"movementCosts",get:function(){return xe(Te,this).movementCosts}},{key:"moveOnWater",get:function(){return xe(Te,this).moveOnWater||!1}},{key:"moves",get:function(){return xe(Me,this)}},{key:"row",get:function(){return xe(Ee,this).row}},{key:"col",get:function(){return xe(Ee,this).col}},{key:"activate",value:function(){!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&this.canContinueOnPath?this.moveOneTurn():Oe(Ce,this,null)}},{key:"deactivate",value:function(){!0===(arguments.length>0&&void 0!==arguments[0]&&arguments[0])&&Oe(Me,this,0)}},{key:"destroy",value:function(){Oe(Me,this,0),Oe(Ae,this,[]),this.deleted=!0,Oe(Ce,this,null)}},{key:"prepareForNewTurn",value:function(){Oe(Me,this,xe(Te,this).movementPoints)}},{key:"setPath",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:mn;if(!vn(e))throw new TypeError("Movable.setPath expects to be assigned a Hex!");var n=Se(xe(Ee,this),e,this,t);return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:mn;if(!Array.isArray(e)||0===e.length||e.some(function(e){return!vn(e)}))return!1;for(var n=1;n<e.length;n++){var r=e[n-1],i=e[n];if(1!==t.distance(r,i))return!1}return!0}(n,t)?(Oe(Ae,this,n),Oe(Ce,this,ke(Ie,this,Le).call(this))):(console.warn("Sam, no path found!"),Oe(Ce,this,null))}},{key:"moveOneStep",value:function(){if(null!==xe(Ce,this)){var e=xe(Ce,this).next();Oe(Ee,this,e.value),(e.done||xe(Ae,this).length<=0)&&Oe(Ce,this,null)}}},{key:"moveOneTurn",value:function(){for(;this.canContinueOnPath;)this.moveOneStep()}}],r=[{key:"isInstanceofMovable",value:function(t){return t instanceof e}},{key:"isActivatableMovable",value:function(t){return e.isInstanceofMovable(t)&&!1===t.deleted}},{key:"isMovableCanMove",value:function(t){return e.isActivatableMovable(t)&&t.moves>0}}],n&&me(t.prototype,n),r&&me(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,r}();function Le(){var e,t;return he().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(xe(Ae,this).length>0)){n.next=12;break}if(e=xe(Ae,this)[0],t=gn(this,e),!(xe(Me,this)<t)){n.next=6;break}return this.deactivate(!0),n.abrupt("break",12);case 6:return Oe(Me,this,xe(Me,this)-t),Oe(Ee,this,e),n.next=10,xe(Ae,this).shift();case 10:n.next=0;break;case 12:case"end":return n.stop()}},ye,this)}function We(e){return We="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},We(e)}function Ne(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function De(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_e(r.key),r)}}function _e(e){var t=function(e){if("object"!=We(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=We(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==We(t)?t:t+""}function Re(e){var t="function"==typeof Map?new Map:void 0;return Re=function(e){if(null===e||!function(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return function(e,t,n){if(Ue())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,t);var i=new(e.bind.apply(e,r));return n&&Fe(i,n.prototype),i}(e,arguments,He(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),Fe(n,e)},Re(e)}function Ue(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(Ue=function(){return!!e})()}function Fe(e,t){return Fe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Fe(e,t)}function He(e){return He=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},He(e)}var Ge=[],Ve=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t,n){return t=He(t),function(e,t){if(t&&("object"==We(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Ue()?Reflect.construct(t,n||[],He(e).constructor):t.apply(e,n))}(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Fe(e,t)}(t,e),n=t,r=[{key:"on",value:function(e,t){this.addEventListener(e,t)}},{key:"off",value:function(e,t){this.removeEventListener(e,t)}},{key:"emit",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.dispatchEvent(new CustomEvent(e,{detail:t}))}}],r&&De(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(Re(EventTarget)),ze={events:new Ve,players:[],turn:0,activeUnit:null,currentPlayer:null,intCurrentPlayer:null,graphics:{},uiDisplays:{},startRound:function(){var e=this;this.players.forEach(function(e){e.units=e.units}),ze.scenes.getScene("mainGameScene"),mn.forEach(function(t){e.nations.forEach(function(e){t.tile.nation===e?t.tile.claimTerritory(e,1):t.tile.claims(e)>0&&t.tile.claimTerritory(e,-1)}),e.players.forEach(function(e){t.tile.faction===e?t.tile.claimTerritory(e,1):t.tile.claims(e)>0&&t.tile.claimTerritory(e,-1)}),t.tile.food=0,t.tile.laborers.size}),mn.forEach(function(e){e.city instanceof zt&&(e.city,mn.traverse(Z({start:[e.q,e.r],radius:2})).forEach(function(e){}))}),this.turn++,ze.uiDisplays.round.setText("Round ".concat(this.turn)),this.startTurn(0)},startTurn:function(e){if(!Number.isFinite(e))throw new TypeError("Unknown player ".concat(e));if(this.currentPlayer=this.players[e],!(this.currentPlayer instanceof wt))throw new TypeError("Player ".concat(e," is not a Faction Object"));ze.uiDisplays.faction.setText("".concat(this.currentPlayer.name,"'s Turn")).setX(14+ze.uiDisplays.round.displayWidth+10).setColor(0===e?"goldenrod":"lightgrey"),this.intCurrentPlayer=e,this.currentPlayer.units.forEach(function(e){e.prepareForNewTurn()}),this.currentPlayer.activateUnit(0)},markTerritory:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.graphics,r=void 0===n?this.graphics.territoryLines:n,i=t.lineOffset,o=void 0===i?.97:i,a=t.offsetX,s=void 0===a?0:a,u=t.offsetY,c=void 0===u?0:u,l=t.fill,f=void 0!==l&&l,h=t.lineWidth,y=void 0===h?5:h;(vn(e)?[e]:mn).forEach(function(e){if(Ut.isTile(e.tile)&&e.tile.faction instanceof wt){!1===f?r.lineStyle(y,e.tile.faction.color):r.fillStyle(e.tile.faction.color),r.beginPath();var t=e.corners.map(function(t){return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.9,r=(e.y-t.y)/(e.x-t.x),i=e.y-r*e.x,o=(e.x-t.x)*n+t.x;return{x:o,y:r*o+i}}(t,e,o)}),n=function(e){return function(e){if(Array.isArray(e))return e}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return Ne(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ne(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(t),i=n[0],a=n.slice(1);r.moveTo(i.x+s,i.y+c),a.forEach(function(e){var t=e.x,n=e.y;r.lineTo(t+s,n+c)}),r.closePath()[!1===f?"strokePath":"fillPath"]()}})},endTurn:function(){console.log("Sam, endTurn!"),this.intCurrentPlayer++,this.intCurrentPlayer>=this.players.length?this.endRound():this.startTurn(this.intCurrentPlayer)},endRound:function(){var e=this;console.log("Sam, endRound!"),ze.scenes.getScene("mainGameScene");ze.uiDisplays.faction.setX(14+ze.uiDisplays.round.displayWidth+10).setText("End of Round").setColor("lightgrey");var t=[];mn.forEach(function(e){e.city instanceof zt&&t.push(e)}),(Ge=Ge.filter(function(e){var t=e.num,n=e.sprite;return t>0&&n instanceof Phaser.GameObjects.Sprite&&n.active})).forEach(function(e,t){}),mn.forEach(function(e){e.tile.laborers.size>0&&(e.tile.food,e.tile.laborers.size,Ht.FOOD_CONSUMPTION),e.tile.food-=e.tile.laborers.size*Ht.FOOD_CONSUMPTION}),Promise.all([]).then(function(){ze.uiDisplays.money.setText(ze.players[0].money.toLocaleString("en-Us")),e.startRound()})}};function Ke(e){return Ke="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ke(e)}function Be(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Ye(r.key),r)}}function Ye(e){var t=function(e){if("object"!=Ke(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Ke(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Ke(t)?t:t+""}function Je(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function Xe(e,t){return e.get(Qe(e,t))}function $e(e,t,n){return e.set(Qe(e,t),n),n}function Qe(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}ze.events.on("end-turn",ze.endTurn.bind(ze));var Ze=new Map,et=new WeakMap,tt=new WeakMap,nt=new WeakMap,rt=function(){return e=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Je(this,et,void 0),Je(this,tt,void 0),Je(this,nt,void 0),$e(et,this,{x:t.hex.x,y:t.hex.y}),$e(tt,this,n),$e(nt,this,n.add.sprite(Xe(et,this).x,Xe(et,this).y,"unit.".concat(t.unitType)).setTint(3684408).setDepth(11)),Xe(nt,this).setScale(80/Xe(nt,this).width)},(t=[{key:"scene",get:function(){return Xe(tt,this)}},{key:"sprite",get:function(){return Xe(nt,this)}},{key:"x",get:function(){return Xe(et,this).x}},{key:"y",get:function(){return Xe(et,this).y}},{key:"update",value:function(e){Xe(et,this).x=e.x,Xe(et,this).y=e.y}}])&&Be(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function it(e){if(Ze.has(e)){var t=Ze.get(e);t.sprite.setVisible(!1),t.sprite.destroy(),Ze.delete(e)}}function ot(e){return ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ot(e)}function at(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function st(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ut(r.key),r)}}function ut(e){var t=function(e){if("object"!=ot(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=ot(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ot(t)?t:t+""}function ct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(ct=function(){return!!e})()}function lt(e,t,n,r){var i=ft(ht(1&r?e.prototype:e),t,n);return 2&r&&"function"==typeof i?function(e){return i.apply(n,e)}:i}function ft(){return ft="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=ht(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},ft.apply(null,arguments)}function ht(e){return ht=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ht(e)}function yt(e,t){return yt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},yt(e,t)}function pt(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}function vt(e,t,n){switch(e){case"u":n%2==0&&t--,n--;break;case"i":t--;break;case"o":n%2==0&&t--,n++;break;case"j":n%2==1&&t++,n--;break;case"k":t++;break;case"l":n%2==1&&t++,n++;break;default:throw new TypeError("Unknown action tile '".concat(e,"'"))}return[t,n]}var dt=new WeakMap,mt=function(e){function t(e,n){var r,i,o=n.hex,a=n.faction;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),!wt.isFaction(a))throw new TypeError("Unit expects to be assigned a Faction!");return function(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}(i=function(e,t,n){return t=ht(t),function(e,t){if(t&&("object"==ot(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,ct()?Reflect.construct(t,n||[],ht(e).constructor):t.apply(e,n))}(this,t,[{base:null!==(r=le.units[e])&&void 0!==r?r:function(e){throw new TypeError(e)}("Unknown unit '".concat(e,"'")),hex:o,faction:a}]),dt,void 0),function(e,t,n){e.set(pt(e,t),n)}(dt,i,e),ze.events.emit("unit-created",{unit:i}),i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&yt(e,t)}(t,e),n=t,r=[{key:"unitType",get:function(){return function(e,t){return e.get(pt(e,t))}(dt,this)}},{key:"deactivate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];lt(t,"deactivate",this,3)([e]),ze.activeUnit=null,ze.events.emit("unit-deactivated",{unit:this}),this.faction.checkEndTurn()}},{key:"activate",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];lt(t,"activate",this,3)([e]),ze.activeUnit=this,0===this.faction.index?ze.events.emit("unit-activated",{unit:this}):this.deactivate(!0)}},{key:"destroy",value:function(){this.deactivate(!0),lt(t,"destroy",this,3)([]),it(this)}},{key:"doAction",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:mn;try{var r=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],u=!0,c=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){c=!0,i=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw i}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return at(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?at(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(vt(e,this.row,this.col),2),i=r[0],o=r[1],a=n.getHex({row:i,col:o});lt(t,"setPath",this,3)([a,n]),lt(t,"moveOneStep",this,3)([])}catch(e){}}}],i=[{key:"isUnit",value:function(e){return e instanceof t}},{key:"isActivatableUnit",value:function(e){return t.isUnit(e)&&!1===e.deleted}},{key:"isMovableUnit",value:function(e){return t.isActivatableUnit(e)&&e.moves>0}}],r&&st(n.prototype,r),i&&st(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(qe);mt.isUnit;var bt=null;function gt(e){var t=this,n=e.index,r=function(e){var t;return null!==(t=[3329330,16711680,255][e])&&void 0!==t?t:11184810}(n),i=null==le?void 0:le.FactionNames[n],o=0,a=[];Object.defineProperties(this,{color:{enumerable:!0,get:function(){return r}},index:{enumerable:!0,get:function(){return n}},money:{enumerable:!0,get:function(){return o},set:function(e){if(!Number.isFinite(e)||e<0)throw new TypeError("Faction.money expects to be assigned a positive number!");o=e}},name:{enumerable:!0,get:function(){return i}},nation:{enumerable:!0,get:function(){return ze.nations[0]}},units:{enumerable:!0,get:function(){return a},set:function(e){if(!Array.isArray(e))throw new TypeError("Faction.units expects to be assigned an Array!");a=e.filter(mt.isActivatableUnit)}},activeUnit:{enumerable:!0,get:function(){if(Number.isInteger(bt)&&bt>=0&&bt<=a.length)return a[bt]},set:function(e){Number.isInteger(e)&&e>=0?bt=e%a.length:null===e&&(bt=null)}}}),ze.events.on("unit-moved",function(e){e.detail.faction!==t&&e.detail.unit.faction!==t||e.detail.promise.then(t.checkEndTurn.bind(t))})}Object.assign(gt.prototype,{addUnit:function(e,t){this.units.push(new mt(e,{hex:t,faction:this}))},checkEndTurn:function(){this.activateNext()||ze.events.emit("end-turn",{faction:this})},activateUnit:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:bt;return 0===this.units.length?(ze.events.emit("end-turn",{faction:this}),!1):!!mt.isActivatableUnit(this.units[e])&&(this.units[e].activate(),bt=e,!0)},activateNext:function(){var e=function(e,t){for(var n=0;n<e.length;n++){var r=(t+1+n)%e.length;if(mt.isMovableUnit(e[r]))return e[r]}return!1}(this.units,bt);return!!mt.isMovableUnit(e)&&(bt=this.units.indexOf(e),e.activate(),!0)}}),gt.isFaction=function(e){return e instanceof gt};const wt=gt;function xt(e){var t,n,r,i=e.index,o=null!==(t=[3329330,16711680,255][i])&&void 0!==t?t:11184810,a=(i+1)%3,s=null!==(n=null===(r=le.NationNames)||void 0===r?void 0:r[i])&&void 0!==n?n:"Unknown";Object.defineProperties(this,{color:{enumerable:!0,get:function(){return o}},frame:{enumerable:!0,get:function(){return a}},index:{enumerable:!0,get:function(){return i}},name:{enumerable:!0,get:function(){return s}}})}Object.assign(xt.prototype,{}),xt.isNation=function(e){return e instanceof xt};const Ot=xt;function kt(e){return kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},kt(e)}function St(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Tt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?St(Object(n),!0).forEach(function(t){Pt(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):St(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Pt(e,t,n){return(t=Et(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function jt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Et(r.key),r)}}function Et(e){var t=function(e){if("object"!=kt(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=kt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==kt(t)?t:t+""}function Ct(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function Mt(e,t){return e.get(It(e,t))}function At(e,t,n){return e.set(It(e,t),n),n}function It(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}function qt(e,t,n){var r;return!!vn(e)&&"string"==typeof t&&""!==t&&t in le.improvements&&(""===n.key||n.key===t)&&e.terrain.terrain in(null===(r=le.improvements[t])||void 0===r?void 0:r.terrains)&&!zt.isCity(e.city)}var Lt=new WeakMap,Wt=new WeakMap,Nt=new WeakMap,Dt=new WeakMap,_t=new WeakMap,Rt=new WeakMap,Ut=function(){function e(t){var n=t.hex;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Ct(this,Lt,{faction:new Map,nation:new Map}),Ct(this,Wt,void 0),Ct(this,Nt,void 0),Ct(this,Dt,{key:""}),Ct(this,_t,new Set),Ct(this,Rt,0),!vn(n))throw new TypeError("Tile expects to be assigned object instance of Hex!");At(Wt,this,n)}return t=e,n=[{key:"faction",get:function(){var e={faction:null,claim:0};return Mt(Lt,this).faction.forEach(function(t,n){e.claim<t&&(e.faction=n,e.claim=t)}),e.faction}},{key:"hex",get:function(){return Mt(Wt,this)}},{key:"improvement",get:function(){return Mt(Nt,this)||{}}},{key:"laborers",get:function(){return Mt(_t,this)},set:function(e){if(!Ht.isLaborer(e))throw new TypeError("Tile.laborers expects to be assigned object instance of Laborer!");Mt(_t,this).add(e)}},{key:"nation",get:function(){var e={nation:null,claim:0};return Mt(Lt,this).nation.forEach(function(t,n){e.claim<t&&(e.nation=n,e.claim=t)}),e.nation}},{key:"claims",value:function(e,t){var n=null;return wt.isFaction(e)?n="faction":Ot.isNation(e)&&(n="nation"),n in Mt(Lt,this)?(Number.isInteger(t)&&0!==t&&Mt(Lt,this)[n].set(e,(Mt(Lt,this)[n].get(e)||0)+t),Mt(Lt,this)[n].get(e)||0):Mt(Lt,this)}},{key:"claimTerritory",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(Number.isFinite(t)&&0!==t){var n,r=void 0;Ot.isNation(e)&&Ot.isNation(this.nation)?r=this.nation.index:wt.isFaction(e)&&wt.isFaction(this.faction)&&(r=this.faction.index),this.claims(e,t),wt.isFaction(e)&&(null===(n=this.faction)||void 0===n?void 0:n.index)!==r&&(ze.markTerritory(this.hex,{graphics:ze.graphics.territoryFills,lineOffset:1,fill:!0}),ze.markTerritory(this.hex,{graphics:ze.graphics.territoryLines,lineOffset:.97,fill:!1}))}}},{key:"isValidImprovement",value:function(e){return qt(Mt(Wt,this),e,Mt(Dt,this))}},{key:"setImprovement",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return"destroy"===e?(At(Nt,this,void 0),At(Dt,this,{key:""}),!0):!!qt(Mt(Wt,this),e,Mt(Dt,this))&&(At(Nt,this,Tt(Tt({},le.improvements[e]),{},{key:e})),t instanceof wt&&(this.claimTerritory(t,10),Mt(Nt,this).faction=t),Mt(Dt,this).key=e,!0)}}],r=[{key:"isTile",value:function(t){return t instanceof e}}],n&&jt(t.prototype,n),r&&jt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,r}();function Ft(){var e,t,n,r,i,o,a,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},u=s.city,c=(s.faction,s.hex),l=s.sprite,f=void 0===l?"laborers.farmer":l,h=s.tile,y=(e=["Gaius","Lucius","Marcus","Quintus","Titus","Publius","Aulus","Sextus"],t=["Bran","Cai","Elen","Rhiannon","Taran","Mabon","Nia","Owain"],n=["Agricola","Felix","Silvanus","Varus","Florus","Crispus","Severus","Vitalis"],r=["the Smith","of Londinium","the Younger","the Red","from Camulodunum","the Hunter"],i=Math.random()<.5?e[Math.floor(Math.random()*e.length)]:t[Math.floor(Math.random()*t.length)],o=n[Math.floor(Math.random()*n.length)],a=Math.random()<.3?r[Math.floor(Math.random()*r.length)]:"","".concat(i," ").concat(o," ").concat(a).trim());zt.isCity(u)&&Object.defineProperty(this,"city",{enumerable:!0,get:function(){return u}}),(vn(c)||vn(null==h?void 0:h.hex))&&Object.defineProperty(this,"hex",{enumerable:!0,get:function(){return c||(null==h?void 0:h.hex)}}),(Ut.isTile(h)||Ut.isTile(null==c?void 0:c.tile))&&Object.defineProperty(this,"tile",{enumerable:!0,get:function(){return h||(null==c?void 0:c.tile)}}),Object.defineProperties(this,{name:{enumerable:!0,get:function(){return y}},sprite:{enumerable:!0,get:function(){return f}}})}Object.assign(Ft.prototype,{assignTile:function(e){if(!Ut.isTile(e))throw new TypeError("Laborer.assignTile expects to be passed object instance of Tile!");this.tile=e}}),Ft.FOOD_CONSUMPTION=2,Ft.isLaborer=function(e){return e instanceof Ft};const Ht=Ft;var Gt=null;function Vt(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.col,n=e.row,r=e.level,i=void 0===r?1:r,o=e.nation;if(null===Gt&&(Gt=ze.scenes.getScene("mainGameScene")),!Ot.isNation(o))throw new TypeError("City expects to be assigned a Nation!");var a=mn.getHex({row:n,col:t});a.tile.setImprovement("destroy");var s=Gt.add.image(a.x,a.y,"cities",o.frame).setDepth(10).setScale(.8);a.city=this;var u=new Set,c=[];mn.traverse(Z({start:[a.q,a.r],radius:1})).forEach(function(e){e.tile.claimTerritory(o,100)}),mn.traverse($({center:[a.q,a.r],radius:2})).forEach(function(e){e.terrain.isWater&&e.tile.claimTerritory(o,50)}),Object.defineProperties(this,{hex:{enumerable:!0,get:function(){return a}},laborers:{enumerable:!0,get:function(){return u},set:function(e){if(!(e instanceof Ht))throw new TypeError("City.laborers expects to be assigned object instance of Laborer!");return u.add(e),!0}},nation:{enumerable:!0,get:function(){return o}},sprite:{get:function(){return s}},level:{enumerable:!0,get:function(){return i}},queue:{enumerable:!0,get:function(){return c}}})}Object.assign(Vt.prototype,{addToQueue:function(e){var t=e.faction,n=e.unitType;n in le.units?this.queue.push({unitType:n,faction:t}):console.warn("City production queue: Unknown unit key ".concat(n))}}),Vt.isCity=function(e){return e instanceof Vt};const zt=Vt;function Kt(e){return Kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Kt(e)}function Bt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Yt(r.key),r)}}function Yt(e){var t=function(e){if("object"!=Kt(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Kt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Kt(t)?t:t+""}function Jt(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(Jt=function(){return!!e})()}function Xt(e){return Xt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Xt(e)}function $t(e,t){return $t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},$t(e,t)}function Qt(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function Zt(e,t){return e.get(tn(e,t))}function en(e,t,n){return e.set(tn(e,t),n),n}function tn(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var nn=new WeakMap,rn=new WeakMap,on=new WeakMap,an=new WeakMap,sn=function(e){function t(e,n){var r,i=n.hex,o=n.num,a=void 0===o?1:o;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),!t.isValidGoodsType(e))throw new TypeError("Unknown Goods type '".concat(e,"'"));return Qt(r=function(e,t,n){return t=Xt(t),function(e,t){if(t&&("object"==Kt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Jt()?Reflect.construct(t,n||[],Xt(e).constructor):t.apply(e,n))}(this,t,[{base:le.ResourceTransporter,hex:i}]),nn,void 0),Qt(r,rn,void 0),Qt(r,on,0),Qt(r,an,void 0),en(nn,r,e),en(rn,r,a),en(an,r,i),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$t(e,t)}(t,e),n=t,i=[{key:"isGoods",value:function(e){return e instanceof t}},{key:"isValidGoodsType",value:function(e){var t;return"object"===Kt(null!==(t=le.goods[e])&&void 0!==t&&t)}}],(r=[{key:"goodsType",get:function(){return Zt(nn,this)}},{key:"num",get:function(){return Zt(rn,this)},set:function(e){if(!Number.isInteger(e)||e<0)throw new TypeError("Goods.num expects to be assigned a nonnegative integer!");en(rn,this,e)}},{key:"rounds",get:function(){return Zt(on,this)},set:function(e){if(!Number.isInteger(e)||e<0)throw new TypeError("Goods.rounds expects to be assigned a nonnegative integer!");en(on,this,e)}},{key:"start",get:function(){return Zt(an,this)}}])&&Bt(n.prototype,r),i&&Bt(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(qe);function un(e){return un="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},un(e)}function cn(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(cn=function(){return!!e})()}function ln(e){return ln=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ln(e)}function fn(e,t){return fn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},fn(e,t)}function hn(e,t,n){return(t=yn(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function yn(e){var t=function(e){if("object"!=un(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=un(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==un(t)?t:t+""}var pn=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hn(e=function(e,t,n){return t=ln(t),function(e,t){if(t&&("object"==un(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,cn()?Reflect.construct(t,n||[],ln(e).constructor):t.apply(e,n))}(this,t,[].concat(r)),"f_cost",void 0),hn(e,"h_cost",void 0),hn(e,"g_cost",void 0),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fn(e,t)}(t,e),n=t,Object.defineProperty(n,"prototype",{writable:!1}),n;var n}(q({dimensions:100,orientation:E.FLAT,origin:"topLeft"}));function vn(e){return e instanceof C}var dn,mn=new re(pn,(dn={width:15,height:6},function(e,t){var n,r=dn.width,i=dn.height,o=dn.start,a=dn.direction,s=void 0===a?G.E:a,u=null!==(n=null!=o?o:t)&&void 0!==n?n:[0,0],c=X(Y({start:u,direction:T(s,2),length:i}),Y({direction:s,length:r-1}))(e,u);return!o&&t?c.slice(1):c}));function bn(e,t){if(!vn(e))return!1;if(!qe.isInstanceofMovable(t))return!1;if(mt.isUnit(t)){if(zt.isCity(e.city)&&e.city.nation!==t.faction.nation&&(!t.attack||!t.attackCities))return!1}else sn.isGoods(t);var n=gn(t,e);return!!Number.isFinite(n)&&n<=t.baseMovementPoints}function gn(e,t){var n,r,i;return arguments.length>2&&void 0!==arguments[2]||e.hex,vn(t)&&qe.isInstanceofMovable(e)?t.terrain.isWater&&!e.moveOnWater?null!==(i=e.movementCosts[t.terrain.terrain])&&void 0!==i?i:1/0:null!==(n=null!==(r=e.movementCosts[t.terrain.terrain])&&void 0!==r?r:t.terrain.movementCost)&&void 0!==n?n:1/0:1/0}function wn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function xn(e){return xn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xn(e)}function On(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Tn(r.key),r)}}function Sn(e,t,n){return t&&kn(e.prototype,t),n&&kn(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Tn(e){var t=function(e){if("object"!=xn(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=xn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==xn(t)?t:t+""}var Pn=function(){return Sn(function e(t){var n=this;On(this,e),["execute","isValid","label"].forEach(function(e){e in t&&(n["#".concat(e)]=t[e],delete t[e])}),Object.assign(this,t)},[{key:"isValid",value:function(e){if("string"==typeof e.menu&&!this.showIn.includes(e.menu))return!1;if(!0===this["#isValid"])return!0;if(Array.isArray(this.unitTypes)&&(!mt.isUnit(e.unit)||!this.unitTypes.includes(e.unit.unitType)))return!1;var t=En[this["#isValid"]];return"function"!=typeof t||t(e)}},{key:"execute",value:function(e){var t=Cn[this["#execute"]];return!!this.isValid(e)&&("function"==typeof t?Promise.try(function(){ze.events.emit("doing-action")}).then(function(){t(e)}):void console.warn("No executor for action ".concat(this.key)))}},{key:"label",get:function(){var e=Mn[this["#label"]];return"function"==typeof e?e(context):this["#label"]}}])}(),jn=new Map;le.actions.forEach(function(e){var t=new Pn(e);jn.set(t.key,t)});var En={currentPlayerTurn:function(){return ze.currentPlayer===ze.players[0]},hexTileValid:function(e){var t=e.hex;return vn(t)&&Ut.isTile(t.tile)},isCityTile:function(e){var t=e.hex;return zt.isCity(t.city)},isFarmBuildable:function(e){var t=e.hex,n=e.unit;return t===n.hex&&!!En.hexTileValid({hex:t})&&"farmer"===n.unitType&&t.tile.isValidImprovement("farm")},isHexControlled:function(e){var t=e.hex,n=e.faction;return t.tile.faction===n},isLegalMove:function(e){var t=e.hex,n=e.unit;return t!==n.hex&&bn(t,n)}},Cn={buildFarm:function(e){var t=e.unit,n=e.hex;n.tile.setImprovement("farm",t.faction),n.tile.laborers=new Ht({hex:n,faction:t.faction,sprite:"laborers.farmer"}),t.destroy()},endTurn:function(){ze.events.emit("end-turn")},skip:function(e){e.unit.deactivate(!0)},startCityView:function(e){var t=e.hex;ze.scenes.start("city-view",{hex:t})},startMoveTo:function(e){var t=e.unit,n=e.hex;t.setPath(n)&&t.moveOneTurn()},startTileView:function(e){var t=e.hex;ze.scenes.start("tile-view",{hex:t})},wait:function(e){e.unit.deactivate()}},Mn={},An=function(){return Sn(function e(){On(this,e)},null,[{key:"handle",value:function(e,t){var n=jn.get(e);return n instanceof Pn&&!!n.isValid(t)&&(n.execute(t),!0)}},{key:"getAvailableActions",value:function(e){return function(e){return function(e){if(Array.isArray(e))return wn(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return wn(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?wn(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(jn.values()).filter(function(t){return t.isValid(e)})}}])}();function In(e){return In="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},In(e)}function qn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Ln(r.key),r)}}function Ln(e){var t=function(e){if("object"!=In(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=In(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==In(t)?t:t+""}function Wn(e,t,n){Nn(e,t),t.set(e,n)}function Nn(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Dn(e,t){return e.get(Rn(e,t))}function _n(e,t,n){return e.set(Rn(e,t),n),n}function Rn(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}ze.events.on("key-pressed",function(e){var t=e.detail,n=ze.activeUnit;if(mt.isUnit(n)){var r={unit:n,hex:n.hex,faction:n.faction};An.handle(t,r)}});var Un=new WeakMap,Fn=new WeakMap,Hn=new WeakMap,Gn=new WeakMap,Vn=new WeakSet,zn=function(){return function(e,t){return t&&qn(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}(function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),function(e,t){Nn(e,t),t.add(e)}(this,Vn),Wn(this,Un,void 0),Wn(this,Fn,void 0),Wn(this,Hn,void 0),Wn(this,Gn,void 0),!(t instanceof globalThis.Phaser.Scene))throw new Error("InputManager requires a Phaser.Scene instance");switch(_n(Fn,this,t),_n(Gn,this,t.input.keyboard.addKey(globalThis.Phaser.Input.Keyboard.KeyCodes.SHIFT)),_n(Hn,this,Dn(Fn,this).scene.key)){case"city-view":Rn(Vn,this,Kn).call(this);break;case"tile-view":Rn(Vn,this,Bn).call(this);break;case"mainGameScene":Rn(Vn,this,Yn).call(this)}},[{key:"disableKeyboardInput",value:function(){var e,t=null===(e=Dn(Fn,this).input)||void 0===e?void 0:e.keyboard;"object"===In(null!=t&&t)&&(t.enabled=!1,t.removeCapture("SPACE"),t.removeCapture("UP"),t.removeCapture("DOWN"),t.removeCapture("LEFT"),t.removeCapture("RIGHT"))}},{key:"enableKeyboardInput",value:function(){var e,t=null===(e=Dn(Fn,this).input)||void 0===e?void 0:e.keyboard;"object"===In(null!=t&&t)&&(t.enabled=!0,"mainGameScene"===Dn(Hn,this))&&_n(Un,this,t.createCursorKeys())}},{key:"update",value:function(){if("mainGameScene"===Dn(Hn,this)){var e=Dn(Fn,this).cameras.main,t=Dn(Gn,this).isDown?25:5;Dn(Un,this).left.isDown?e.scrollX-=t:Dn(Un,this).right.isDown&&(e.scrollX+=t),Dn(Un,this).up.isDown?e.scrollY-=t:Dn(Un,this).down.isDown&&(e.scrollY+=t)}}},{key:"destroy",value:function(){}}])}();function Kn(){var e=this;Dn(Fn,this).input.keyboard.on("keydown",function(t){"Escape"===t.key&&Dn(Fn,e).scene.stop("city-view")})}function Bn(){var e=this;document.querySelector("#tile-view").addEventListener("contextmenu",function(e){e.preventDefault()}),Dn(Fn,this).input.keyboard.on("keydown",function(t){"Escape"===t.key&&Dn(Fn,e).scene.stop("tile-view")}),this.enableKeyboardInput()}function Yn(){var e=this;ze.domContainer.addEventListener("contextmenu",function(e){e.preventDefault()}),Dn(Fn,this).input.manager.canvas.addEventListener("contextmenu",function(e){e.preventDefault()}),Dn(Fn,this).input.keyboard.on("keydown",function(e){if(!(e.ctrlKey&&["r","R","1","2","3","4","5","6","7","8","9"].includes(e.key)||e.ctrlKey&&"I"===e.key)){switch(e.preventDefault(),e.key){case"q":case"e":case"r":case"t":case"y":case"u":case"i":case"o":case"p":case"a":case"d":case"f":case"g":case"h":case"j":case"k":case"l":case"z":case"x":case"c":case"v":case"b":case"n":case"m":case"F1":case"F2":case"F4":case"F5":case"F3":break;case"w":return void ze.events.emit("key-pressed","wait");case"s":return void ze.events.emit("key-pressed","skip");case"F":ze.events.emit("key-pressed","build-farm");break;case"Escape":ze.events.emit("esc-pressed")}if(["u","i","o","j","k","l"].includes(e.key)){if(!mt.isMovableUnit(ze.activeUnit))return;ze.activeUnit.doAction(e.key)}}});var t=!1,n={x:0,y:0},r={x:0,y:0},i=4;Dn(Fn,this).input.on("pointerdown",function(o){switch(n.x=o.x,n.y=o.y,r.x=Dn(Fn,e).cameras.main.scrollX,r.y=Dn(Fn,e).cameras.main.scrollY,t=!1,o.pointerType){case"touch":i=10;break;case"pen":i=8;break;default:i=4}}),Dn(Fn,this).input.on("pointermove",function(o){if(o.isDown){var a=o.x-n.x,s=o.y-n.y;if(!t&&(Math.abs(a)>i||Math.abs(s)>i)&&(t=!0),t){var u=Dn(Fn,e).cameras.main.zoom||1;Dn(Fn,e).cameras.main.setScroll(r.x-a/u,r.y-s/u)}}}),Dn(Fn,this).input.on("pointerup",function(e){if(!t){var n=mn.pointToHex({x:e.worldX,y:e.worldY});vn(n)&&ze.events.emit("hex-clicked",{hex:n})}t=!1}),this.enableKeyboardInput()}var Jn=null,Xn=null;function $n(){Xn&&(Xn.setAttribute("hidden","true"),Xn.innerHTML="")}const Qn={key:"city-view",preload:function(){},create:function(e){var t=this;if(vn(e.hex)&&Ut.isTile(e.hex.tile)&&zt.isCity(e.hex.city)){this.scene.pause("mainGameScene"),this.scene.moveAbove("mainControls","city-view");var n=ce();Jn=e.hex.city,null!=Xn||(Xn=document.getElementById("production-queue")),Xn.innerHTML="";var r=document.createElement("select"),i=document.createElement("option");i.text="-- Select Unit Type --",i.value="",r.appendChild(i),Object.keys(le.units).forEach(function(e){var t=document.createElement("option");t.value=e,t.text=le.units[e].name,r.appendChild(t)}),Xn.appendChild(r);var o=document.createElement("button");o.innerText="Add to Queue",o.addEventListener("click",function(){Jn.addToQueue({faction:ze.currentPlayer,unitType:r.options[r.selectedIndex].value})}),o.disabled=!0,Xn.appendChild(o),r.addEventListener("change",function(){o.disabled=""===r.options[r.selectedIndex].value}),Xn.appendChild(document.createElement("ul")),Xn.removeAttribute("hidden"),Xn.style.zIndex=1;var a=this.add.graphics({x:0,y:0}).setDepth(0);a.fillStyle(0,.5),a.fillRect(0,0,n.width,n.height);var s=this.add.graphics({x:0,y:0}).setDepth(1);s.fillStyle(0,1),s.fillRect(n.width-100,0,100,100),this.add.text(n.width-100,0,"\xD7 ",{fixedWidth:100,fixedHeight:100,font:"60pt Trebuchet MS",align:"right",color:"white",stroke:"black",strokeThickness:7}).setDepth(2).setInteractive().on("pointerdown",function(){t.scene.stop("city-view")});var u=[e.hex.x,e.hex.y],c=u[0],l=u[1],f=Math.min(n.height,n.width)/7/ue,h=n.width/2,y=n.height/3;mn.traverse(Z({start:[e.hex.q,e.hex.r],radius:2})).forEach(function(e){var n={x:(e.x-c)*f+h,y:(e.y-l)*f+y},r=t.add.image(n.x,n.y,"tile.".concat(e.terrain.terrain)).setDepth(1);if(r.scaleX=f,r.scaleY=f,ze.markTerritory(e,{offsetX:0-e.x+h+(e.x-c)*f,offsetY:0-e.y+y+(e.y-l)*f,graphics:s.setDepth(2),lineOffset:.95*f}),e.tile.laborers.size>0){var i=ue*f;t.add.text(n.x-i/2,n.y+i/4,"Food: ".concat((e.terrain.food||0)+(e.tile.improvement.food||0)),{font:"14pt Trebuchet MS",align:"center",color:"white",stroke:"black",strokeThickness:7,fixedWidth:i}).setDepth(3)}}),this.inputManager=new zn(this),this.events.on("sleep",function(){$n(),t.scene.wake("mainGameScene")}).on("shutdown",function(){$n(),t.scene.wake("mainGameScene")})}else this.scene.resume("mainGameScene")},update:function(){var e=document.querySelector("#production-queue > ul");e.querySelectorAll("li").length!==Jn.queue.length&&(e.innerHTML="",Jn.queue.forEach(function(t){var n=t.faction,r=t.unitType,i=document.createElement("li");i.innerText="".concat(n.name,": ").concat(le.units[r].name),e.appendChild(i)}))}};var Zn="mainControls";const er={key:Zn,autoStart:!0,preload:function(){this.load.image("coins","img/resources/coins.png")},create:function(){var e=ze.graphics.mainControls=this.add.graphics({x:0,y:0}),t=15;ze.uiDisplays.round=this.add.text(14,t,"Round ".concat(ze.turn),{fontFamily:"Trebuchet MS",fontSize:"28px",color:"white",stroke:"black",strokeThickness:5,maxLines:1}),ze.uiDisplays.faction=this.add.text(14+ze.uiDisplays.round.displayWidth+10,t+2,"",{fontFamily:"Trebuchet MS",fontSize:"26px",color:"white",stroke:"black",strokeThickness:5,maxLines:1}),t+=ze.uiDisplays.faction.displayHeight+5,t-=15;var n=this.add.image(0,t,"coins").setDepth(2);n.setScale(32/n.width),n.x=20+n.displayWidth/2,n.y=t+=20+n.displayHeight/2,ze.uiDisplays.money=this.add.text(n.x+n.displayWidth/2+6,n.y-n.displayHeight/2-4,ze.players[0].money.toLocaleString("en-Us"),{fontFamily:"Trebuchet MS",fontSize:"28px",color:"gold",stroke:"black",strokeThickness:5,maxLines:1}).setLetterSpacing(1),t+=ze.uiDisplays.money.displayHeight,e.fillStyle(0,.5),e.fillRect(0,0,ce().width,t),this.game.events.emit("scene-created-".concat(Zn))},update:function(){}};function tr(e){return tr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tr(e)}function nr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function rr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?nr(Object(n),!0).forEach(function(t){ir(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nr(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function ir(e,t,n){return(t=function(e){var t=function(e){if("object"!=tr(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=tr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==tr(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var or=new Map,ar={ease:"Linear",duration:1e3,yoyo:!1},sr=new Map;function ur(e){return ur="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ur(e)}function cr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function lr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?cr(Object(n),!0).forEach(function(t){fr(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):cr(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function fr(e,t,n){return(t=function(e){var t=function(e){if("object"!=ur(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=ur(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ur(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function hr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],u=!0,c=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){c=!0,i=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw i}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return yr(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?yr(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function yr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var pr="mainGameScene",vr=null,dr={spriteOnActiveUnit:null,shortcutKeys:[]};function mr(){var e;if(void 0!==globalThis.Phaser){var t=ce();for(null===(e=dr.spriteOnActiveUnit)||void 0===e||e.setActive(!1).setPosition(t.offscreen,t.offscreen).setDepth(0);dr.shortcutKeys.length>0;)dr.shortcutKeys.pop().destroy()}}ze.events.on("unit-deactivated",mr),ze.events.on("unit-moving",mr),ze.events.on("unit-activated",function(e){mr(),function(e){if(void 0!==globalThis.Phaser){var t=e.detail.unit,n=t.hex;dr.spriteOnActiveUnit.setActive(!0).setVisible(!0).setPosition(n.x,n.y).setDepth(98),["L","K","J","U","I","O"].forEach(function(e){var n=hr(vt(e.toLowerCase(),t.row,t.col),2),r=n[0],i=n[1],o=mn.getHex({row:r,col:i});if(bn(o,t)){var a=vr.add.text(o.x-100,o.y+ue/6,e,{fixedWidth:ue,font:"25pt Trebuchet MS",align:"center",color:"khaki",stroke:"black",strokeThickness:7}).setOrigin(0).setDepth(98);dr.shortcutKeys.push(a),vr.cameras.getCamera("mini").ignore(a)}})}}(e)}),ze.events.on("unit-activated",function(e){if(void 0!==globalThis.Phaser){var t=e.detail.unit.hex;vr.cameras.main.pan(t.x,t.y,500,"Linear",!0)}}),ze.events.on("unit-created",function(e){!function(e,t){Ze.has(e)||Ze.set(e,new rt(e,t)),Ze.has(e)}(e.detail.unit,vr)});const br={key:pr,autoStart:!0,preload:function(){var e=this;Object.entries(le.terrains).forEach(function(t){var n=hr(t,2),r=n[0],i=n[1];e.load.image("tile.".concat(r),"img/tiles/".concat(i.tile,".png"))}),this.load.spritesheet("cities","img/tiles/cities.png",{frameHeight:200,frameWidth:200}),Object.entries(le.improvements).forEach(function(t){var n=hr(t,2),r=n[0],i=n[1];"string"==typeof i.tile&&i.tile.length>0&&e.load.image("improvements.".concat(r),"img/improvements/".concat(i.tile,".png"))}),Object.entries(le.goods).forEach(function(t){var n=hr(t,2),r=n[0],i=n[1];"string"==typeof i.tile&&i.tile.length>0&&e.load.image("goods.".concat(r),"img/resources/".concat(i.tile,".png"))}),this.load.image("laborers.farmer","img/laborers/farmer.png"),this.load.image("activeUnit","img/activeUnit.png"),Object.keys(le.units).forEach(function(t){e.load.image("unit.".concat(t),"img/units/".concat(t,".png"))})},create:function(){var e=this;vr=this,ze.graphics=lr(lr({},ze.graphics),{},{territoryFills:this.add.graphics({x:0,y:0}).setDepth(2),territoryLines:this.add.graphics({x:0,y:0}).setDepth(2)}),mn.forEach(function(t){var n=le.world[t.row][t.col];Object.assign(t,n,{tile:new Ut({hex:t}),terrain:lr(lr({},le.terrains[n.terrain]),{},{terrain:n.terrain}),sprite:e.add.image(t.x,t.y,"tile.".concat(n.terrain)).setDepth(1).setInteractive(new Phaser.Geom.Polygon(mn.getHex({row:0,col:0}).corners),Phaser.Geom.Polygon.Contains),text:e.add.text(t.x-100,t.y+ue/3.6,t.row+"\xD7"+t.col,{fixedWidth:ue,font:"12pt Trebuchet MS",align:"center",color:"white"}).setOrigin(0)})}).forEach(function(e){"object"===ur(e.city)&&null!==e.city&&(e.city=new zt(lr(lr({},e.city),{},{col:e.col,row:e.row,nation:ze.nations[e.city.nation]}))),"string"==typeof e.improvement&&e.tile.setImprovement(e.improvement)});var t=ce();dr.spriteOnActiveUnit=this.add.image(t.offscreen,t.offscreen,"activeUnit").setActive(!1);var n=mn.pixelWidth,r=mn.pixelHeight,i=t.width/2,o=t.height/2;this.cameras.main.setBounds(-i,-o,n+2*i,r+2*o),this.cameras.main.ignore([ze.graphics.territoryFills]);var a=400,s=800;window.innerHeight<600&&(a=300,s=500);var u=this.cameras.add(t.width-s,t.height-a,s,a);u.setZoom(.2).setName("mini").setBackgroundColor(0),u.centerOn(mn.pixelWidth/2,mn.pixelHeight/2),u.ignore([ze.graphics.territoryLines,dr.spriteOnActiveUnit]),ze.players[0].addUnit("rancher",mn.getHex({row:2,col:3}),this),ze.players[0].addUnit("farmer",mn.getHex({row:2,col:4}),this),ze.players[0].addUnit("miner",mn.getHex({row:2,col:2}),this),ze.players[0].addUnit("settler",mn.getHex({row:3,col:3}),this),ze.players[0].addUnit("builder",mn.getHex({row:1,col:3}),this),this.inputManager=new zn(this),this.events.on("pause",function(){ze.scenes.pause("mainControls"),mr(),ze.domContainer.style.zIndex=0,e.inputManager.disableKeyboardInput()}).on("sleep",function(){ze.scenes.sleep("mainControls"),ze.domContainer.style.zIndex=0,e.inputManager.disableKeyboardInput()}),this.events.on("resume",function(){ze.scenes.wake("mainControls"),ze.currentPlayer.activateUnit(),e.inputManager.enableKeyboardInput()}).on("wake",function(){ze.scenes.wake("mainControls"),ze.currentPlayer.activateUnit(),e.inputManager.enableKeyboardInput()}),this.game.events.emit("scene-created-".concat(pr))},update:function(){var e=this;this.inputManager.update(),Ze.forEach(function(e,t){if(t.deleted)it(t);else{if(e.x!==t.hex.x||e.y!==t.hex.y){var n=function(e,t){var n=Ze.get(e);if(n)return new Promise(function(r){ze.events.emit("unit-moving",{unit:e}),n.scene.tweens.add({targets:n.sprite,x:t.x,y:t.y,ease:"Quad.out",duration:800,yoyo:!1,onComplete:function(e){e.destroy(),r()}})})}(t,t.hex);e.update(t.hex),n.then(function(){console.log("Sam, emitting unit-moved"),ze.events.emit("unit-moved",{unit:t,promise:n})})}e.sprite.setVisible(!0),ze.activeUnit===t?e.sprite.setTint(16777215).setDepth(100):e.sprite.setTint(3684408).setDepth(11)}}),Ge.forEach(function(t){return function(e,t){or.has(e)||or.set(e,t.add.sprite(e.hex.x,e.hex.y,"goods.".concat(e.type)).setDepth(20));var n=or.get(e);t.tweens.add(rr(rr({targets:n,x:e.hex.x,y:e.hex.y},ar),{},{onComplete:function(t){n.setVisible(e.num>0),t.destroy()}}))}(t,e)}),mn.forEach(function(t){var n,r;t.tile.improvement.key?function(e,t){var n,r=null===(n=e.improvement)||void 0===n?void 0:n.key;if(r&&!sr.has(e)){var i=t.add.image(e.hex.x,e.hex.y,"improvements.".concat(r)).setDepth(5);sr.set(e,i)}}(t.tile,e):(n=t.tile,(r=sr.get(n))&&(r.destroy(),sr.delete(n)))})}};function gr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}const wr={key:"tile-view",preload:function(){},create:function(e){var t,n=this,r=e.hex;if(vn(r)&&Ut.isTile(r.tile)){console.log("Sam, tile-view created"),this.scene.pause("mainGameScene");var i=document.getElementById("tile-view");!function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.htmlElementId,n=e.imageKey,r=e.scene,i=document.getElementById(t),o=r.textures.get(n);o instanceof Phaser.Textures.Texture&&i instanceof Element&&i.append(o.getSourceImage())}({imageKey:"tile.".concat(r.terrain.terrain),htmlElementId:"terrain",scene:this});var o=i.querySelector("#terrain");if(o instanceof Element){var a=document.createElement("div");a.classList.add("name"),a.innerHTML=r.terrain.name,o.appendChild(a)}if(console.log("Sam, terrain:",r.terrain),(null===(t=r.tile.improvement)||void 0===t?void 0:t.image)instanceof Phaser.GameObjects.Image){var s=i.querySelector("#improvements");if(s instanceof Element){var u=n.textures.exists("tile-view-improvement")?n.textures.get("tile-view-improvement"):n.textures.createCanvas("tile-view-improvement",GameConfig.tileWidth,GameConfig.tileWidth),c=u.getCanvas(),l=u.getContext(),f=Honeycomb.defineHex({dimensions:GameConfig.tileWidth/2,orientation:Honeycomb.Orientation.FLAT,origin:"topLeft"}),h=new Honeycomb.Grid(f,Honeycomb.rectangle({width:1,height:1})).getHex({row:0,col:0});l.fillStyle="white",l.beginPath();var y=function(e){return function(e){if(Array.isArray(e))return e}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return gr(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?gr(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(h.corners.map(function(e){return{x:e.x,y:e.y-h.y+100}})),p=y[0],v=y.slice(1);l.moveTo(p.x,p.y),v.forEach(function(e){var t=e.x,n=e.y;l.lineTo(t,n)}),l.closePath(),l.fill();var d=this.textures.get("improvements.".concat(r.tile.improvement.key)).getSourceImage(),m=u.width/2-d.width/2,b=u.height/2-d.height/2;u.drawFrame("improvements.".concat(r.tile.improvement.key),null,m,b),u.refresh(),s.appendChild(c);var g=document.createElement("div");g.classList.add("name"),g.innerHTML=r.tile.improvement.title,s.appendChild(g)}console.log("Sam, improvement:",r.tile.improvement)}if(r.tile.laborers instanceof Set){console.log("Sam, we have a laborers set!",r.tile.laborers.size);var w=i.querySelector("#laborers");r.tile.laborers.forEach(function(e){var t=document.createElement("img");t.src=n.textures.get(e.sprite).getSourceImage().src,w.appendChild(t)})}else console.log("Sam, no laborers set\u2026");i.removeAttribute("hidden"),this.inputManager=new zn(this),this.events.on("sleep",function(){i.setAttribute("hidden",!0),i.querySelectorAll("div").forEach(function(e){return e.innerHTML=""}),console.log("Sam, tile-view sleep"),n.scene.wake("mainGameScene"),n.inputManager.disableKeyboardInput()}).on("shutdown",function(){i.setAttribute("hidden",!0),i.querySelectorAll("div").forEach(function(e){return e.innerHTML=""}),console.log("Sam, tile-view shutdown"),n.scene.wake("mainGameScene")})}else ze.scenes.resume("mainGameScene")},update:function(){}},xr={CityView:Qn,MainControls:er,MainGame:br,MainMenu:{key:"mainMenu",preload:function(){},create:function(){},update:function(){}},TechTree:{key:"techTree",preload:function(){},create:function(){},update:function(){}},TileView:wr};void 0===globalThis.document&&(globalThis.document={add:function(){return this},addEventListener:function(){return this},appendChild:function(){return this},createElement:function(){return this},getElementById:function(){return this},querySelector:function(){return this},querySelectorAll:function(){return[]},remove:function(){return this},removeAttribute:function(){return this},setAttribute:function(){return this}},globalThis.document.classList=globalThis.document,globalThis.document.style=globalThis.document);var Or=null;function kr(){ze.domContainer.innerHTML="",ze.domContainer.style.zIndex=0}function Sr(e){Or.setAttribute("hidden",!0),Or.innerHTML=""}ze.events.on("phaser-ready",function(){null!=Or||(Or=document.getElementById("tile-menu"))}),ze.events.on("unit-activated",function(e){var t,n=null===(t=e.detail)||void 0===t?void 0:t.unit;if(mt.isUnit(n)&&ze.activeUnit===n&&"undefined"!=typeof Element&&ze.domContainer instanceof Element){ze.domContainer.innerHTML="";var r=document.createElement("div");r.classList.add("unit-actions-menu");var i=ze.currentPlayer,o={menu:"unit-actions-menu",hex:n.hex,unit:n,faction:i};An.getAvailableActions(o).forEach(function(e){var t=document.createElement("button");t.innerHTML=e.label,t.addEventListener("click",function(){e.execute(o)}),"string"==typeof e.description&&""!==e.description&&t.setAttribute("title",e.description),t.style.pointerEvents="auto",r.appendChild(t)}),ze.domContainer.appendChild(r),ze.domContainer.style.zIndex=1}}),ze.events.on("unit-deactivated",kr),ze.events.on("unit-moving",kr),ze.events.on("doing-action",function(){kr(),Sr()}),ze.events.on("hex-clicked",function(e){var t,n,r=(null===(t=e.detail)||void 0===t?void 0:t.hex)||(null===(n=e.detail)||void 0===n||null===(n=n.unit)||void 0===n?void 0:n.hex);if(vn(r)&&Ut.isTile(r.tile)){Sr();var i={menu:"tile-menu",hex:r,unit:ze.activeUnit,faction:ze.currentPlayer},o=An.getAvailableActions(i);if(0!==o.length)if(1!==o.length||"activateUnit"===o[0].key){o.forEach(function(e){var t=document.createElement("button");t.innerHTML=e.label,t.addEventListener("click",function(){e.execute(i)}),"string"==typeof e.description&&""!==e.description&&t.setAttribute("title",e.description),t.style.pointerEvents="auto",Or.appendChild(t)});var a=document.createElement("button");a.innerHTML="Cancel",a.addEventListener("click",Sr),a.style.pointerEvents="auto",Or.appendChild(a),Or.style.zIndex=1,Or.removeAttribute("hidden")}else o[0].execute(i)}}),ze.events.on("esc-pressed",Sr),yodasws.page("pageGame").setRoute({template:"pages/game/game.html",canonicalRoute:"/game/",route:"/game/?"}).on("load",()=>{ze.nations=[new Ot({index:0})],ze.players=[new wt({index:0}),new wt({index:1}),new wt({index:2})];const e=new Phaser.Game({type:Phaser.AUTO,...ce(),zoom:.5,backgroundColor:"#71ABFF",scene:{key:"title-screen",preload(){},create(){},update(){}},parent:document.querySelector("main"),dom:{createContainer:!0}});Promise.all(Object.values(xr).map(t=>(e.scene.add(t.key,t,t.autoStart||!1),!t.autoStart||new Promise(n=>{e.events.once(`scene-created-${t.key}`,n)})))).then(()=>{ze.events.emit("phaser-ready")}).then(()=>{e.scene.moveAbove("mainGameScene","mainControls"),e.scene.isActive("mainGameScene")&&e.scene.isActive("mainControls")&&ze.startRound()}),Object.assign(ze,{scenes:e.scene,domContainer:e.domContainer}),e.domContainer.classList.add("game")}),window.json={},yodasws.page("home").setRoute({template:"pages/home.html",route:"/"}).on("load",()=>{})})()})();