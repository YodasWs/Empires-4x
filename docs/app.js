"use strict";(()=>{var t={601:(t,e,r)=>{"use strict";var n;function i(t,e){a(t,e),e.add(t)}function o(t,e,r){a(t,e),e.set(t,r)}function a(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function s(t,e,r){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return r}function u(t,e,r){return function(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}(t,l(t,e,"set"),r),r}function c(t,e){return function(t,e){return e.get?e.get.call(t):e.value}(t,l(t,e,"get"))}function l(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function f(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=x(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function h(t,e){return h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},h(t,e)}function y(t,e){if(e&&("object"===k(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function v(t){return v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},v(t)}function d(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function p(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?d(Object(r),!0).forEach(function(e){b(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function g(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function m(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function w(t,e,r){return e&&m(t.prototype,e),r&&m(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function b(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function x(t,e){if(t){if("string"==typeof t)return O(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?O(t,e):void 0}}function O(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function k(t){return k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},k(t)}r.r(e);var q=function(t){return Number.isFinite(t)&&!Number.isNaN(t)},P=function(t){return"object"==k(t)&&null!==t},S=function(t){return P(t)&&q(t.col)&&q(t.row)},j=function(t){return Array.isArray(t)&&q(t[0])&&q(t[1])},E=function(t,e){return e+t*(1&e)>>1},T=function(t,e){return function(t,e){return(t%8+8)%8}(t+e)},M=function(t){var e,r,n=(r=3,function(t){if(Array.isArray(t))return t}(e=t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,o=[],a=!0,s=!1;try{for(r=r.call(t);!(a=(n=r.next()).done)&&(o.push(n.value),!e||o.length!==e);a=!0);}catch(t){s=!0,i=t}finally{try{a||null==r.return||r.return()}finally{if(s)throw i}}return o}}(e,r)||x(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=n[0],o=n[1],a=n[2];return{q:i,r:o,s:void 0===a?-i-o:a}};function A(t){var e=t.q,r=t.r,n=t.s,i=q(e),o=q(r),a=q(n);if(i&&o&&a)return{q:e,r,s:n};if(i&&o)return{q:e,r,s:-e-r};if(i&&a)return{q:e,r:-e-n,s:n};if(o&&a)return{q:-r-n,r,s:n};throw new TypeError("Can't determine three cube coordinates from less than two coordinates. Received: { q: ".concat(e,", r: ").concat(r,", s: ").concat(n," }."))}var N=function(t){return t.FLAT="FLAT",t.POINTY="POINTY",t}(N||{});var R=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0];g(this,t),b(this,"q",void 0),b(this,"r",void 0);var r=_(this,e),n=r.q,i=r.r;this.q=n,this.r=i}return w(t,[{key:"center",get:function(){var t=this.width,e=this.height;return{x:t/2-this.x,y:e/2-this.y}}},{key:"col",get:function(){return J(this).col}},{key:"corners",get:function(){var t=this.orientation,e=this.width,r=this.height,n=this.x,i=this.y;return t===N.POINTY?U(e,r,n,i):H(e,r,n,i)}},{key:"dimensions",get:function(){return I.dimensions}},{key:"height",get:function(){var t=this.orientation,e=this.dimensions.yRadius;return t===N.POINTY?2*e:e*Math.sqrt(3)}},{key:"isFlat",get:function(){return this.orientation===N.FLAT}},{key:"isPointy",get:function(){return this.orientation===N.POINTY}},{key:"orientation",get:function(){return I.orientation}},{key:"origin",get:function(){return I.origin}},{key:"offset",get:function(){return I.offset}},{key:"row",get:function(){return J(this).row}},{key:"width",get:function(){var t=this.orientation,e=this.dimensions.xRadius;return t===N.POINTY?e*Math.sqrt(3):2*e}},{key:"x",get:function(){return L(this).x}},{key:"y",get:function(){return L(this).y}},{key:"s",get:function(){return-this.q-this.r}},{key:"clone",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this;return new this.constructor(t)}},{key:"equals",value:function(t){return function(t,e){if(S(t)&&S(e))return t.col===e.col&&t.row===e.row;if(Object.hasOwn(t,"col")||Object.hasOwn(e,"col"))throw new Error("Can't compare coordinates where one are offset coordinates. Either pass two offset coordinates or two axial/cube coordinates. Received: ".concat(JSON.stringify(t)," and ").concat(JSON.stringify(e)));var r=j(t)?M(t):t,n=j(e)?M(e):e;return r.q===n.q&&r.r===n.r}(this,S(t)?Y(this,t):t)}},{key:"toString",value:function(){return"".concat(this.constructor.name,"(").concat(this.q,",").concat(this.r,")")}},{key:"translate",value:function(t){return z(this,t)}}],[{key:"settings",get:function(){var t=this.prototype;return{dimensions:t.dimensions,orientation:t.orientation,origin:t.origin,offset:t.offset}}}]),t}(),I={dimensions:{xRadius:1,yRadius:1},orientation:N.POINTY,origin:{x:0,y:0},offset:-1},U=function(t,e,r,n){return[{x:r+.5*t,y:n-.25*e},{x:r+.5*t,y:n+.25*e},{x:r,y:n+.5*e},{x:r-.5*t,y:n+.25*e},{x:r-.5*t,y:n-.25*e},{x:r,y:n-.5*e}]},H=function(t,e,r,n){return[{x:r+.25*t,y:n-.5*e},{x:r+.5*t,y:n},{x:r+.25*t,y:n+.5*e},{x:r-.25*t,y:n+.5*e},{x:r-.5*t,y:n},{x:r-.25*t,y:n-.5*e}]};function W(t){var e=p(p({},I),t),r=e.dimensions,n=e.orientation,i=e.origin,o=e.offset;return function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&h(t,e)}(u,t);var e,a,s=(e=u,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,r=v(e);if(a){var n=v(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return y(this,t)});function u(){return g(this,u),s.apply(this,arguments)}return w(u,[{key:"dimensions",get:function(){return function(t,e){if(P(t)&&t.xRadius>0&&t.yRadius>0)return t;if(P(t)&&t.width>0&&t.height>0){var r=t.width,n=t.height;return e===N.POINTY?{xRadius:r/Math.sqrt(3),yRadius:n/2}:{xRadius:r/2,yRadius:n/Math.sqrt(3)}}if(t>0)return{xRadius:t,yRadius:t};throw new TypeError("Invalid dimensions: ".concat(JSON.stringify(t),". Dimensions must be expressed as an Ellipse ({ xRadius: number, yRadius: number }), a Rectangle ({ width: number, height: number }) or a number."))}(r,n)}},{key:"orientation",get:function(){return n}},{key:"origin",get:function(){return function(t,e){if(function(t){return P(t)&&q(t.x)&&q(t.y)}(t))return t;if(!e)throw new TypeError("Supply a bounding box ({ width: number, height: number }). Received: ".concat(JSON.stringify(e)));if("topLeft"===t)return{x:-.5*e.width,y:-.5*e.height};throw new TypeError("Invalid origin: ".concat(JSON.stringify(t),". Origin must be expressed as a Point ({ x: number, y: number }) or the string 'topLeft'."))}(i,this)}},{key:"offset",get:function(){return o}}]),u}(R)}var J=function(t){var e=t.q,r=t.r,n=t.offset;return t.isPointy?function(t,e,r){return{col:t+E(r,e),row:e}}(e,r,n):function(t,e,r){return{col:t,row:e+E(r,t)}}(e,r,n)},L=function(t){var e=t.orientation,r=t.dimensions,n=r.xRadius,i=r.yRadius,o=t.origin,a=o.x,s=o.y,u=t.q,c=t.r;return e===N.POINTY?{x:n*Math.sqrt(3)*(u+c/2)-a,y:3*i/2*c-s}:{x:3*n/2*u-a,y:i*Math.sqrt(3)*(c+u/2)-s}},D=function(t,e,r){var n=t-E(r,e);return{q:n,r:e,s:-n-e}},C=function(t,e,r){var n=t,i=e-E(r,t);return{q:n,r:i,s:-n-i}},Y=function(t,e){var r=t.offset,n=t.orientation,i=e.col,o=e.row;return n===N.POINTY?D(i,o,r):C(i,o,r)},F=function(t){var e=A(t),r=e.q,n=e.r,i=e.s,o=Math.round(r),a=Math.round(n),s=Math.round(i),u=Math.abs(r-o),c=Math.abs(n-a),l=Math.abs(i-s);return u>c&&u>l?o=-a-s:c>l?a=-o-s:s=-o-a,{q:o,r:a,s}},$=function(t,e){var r=t.dimensions,n=r.xRadius,i=r.yRadius,o=t.origin,a=t.orientation,s=e.x,u=e.y;return s+=o.x,u+=o.y,a===N.POINTY?F({q:Math.sqrt(3)*s/(3*n)-u/(3*i),r:2/3*(u/i)}):F({q:2/3*(s/n),r:Math.sqrt(3)*u/(3*i)-s/(3*n)})};function _(t,e){return j(e)?M(e):S(e)?Y(t,e):A(e)}function z(t,e){var r=A(t),n=r.q,i=r.r,o=r.s,a=A(e),s={q:n+a.q,r:i+a.r,s:o+a.s};return t instanceof R?t.clone(s):s}function K(t,e,r){var n=_(t,e),i=n.q,o=n.r,a=n.s,s=_(t,r),u=s.q,c=s.r,l=s.s;return Math.max(Math.abs(i-u),Math.abs(o-c),Math.abs(a-l))}var G=function(t){return t[t.N=0]="N",t[t.NE=1]="NE",t[t.E=2]="E",t[t.SE=3]="SE",t[t.S=4]="S",t[t.SW=5]="SW",t[t.W=6]="W",t[t.NW=7]="NW",t}(G||{}),B=[null,{q:1,r:-1},{q:1,r:0},{q:0,r:1},null,{q:-1,r:1},{q:-1,r:0},{q:0,r:-1}],Q=[{q:0,r:-1},{q:1,r:-1},null,{q:1,r:0},{q:0,r:1},{q:-1,r:1},null,{q:-1,r:0}],V=function(t,e){return t.clone(t.isPointy?function(t,e){var r=t.offset,n=t.q,i=t.r,o=t.col,a=t.row;if(e===G.S||e===G.N){var s=e===G.S?a+1:a-1;return D(o,s,r)}var u=B[e];return{q:n+u.q,r:i+u.r}}(t,e):function(t,e){var r=t.offset,n=t.q,i=t.r,o=t.col,a=t.row;if(e===G.E||e===G.W){var s=e===G.E?o+1:o-1;return C(s,a,r)}var u=Q[e];return{q:n+u.q,r:i+u.r}}(t,e))};function X(t){return Array.isArray(t)?function(e,r){var n,i=[],o=r,a=f(t);try{for(a.s();!(n=a.n()).done;){var s,u=f((0,n.value)(e,o));try{for(u.s();!(s=u.n()).done;){var c=s.value;i.push(o=c)}}catch(t){u.e(t)}finally{u.f()}}}catch(t){a.e(t)}finally{a.f()}return i}:t}function Z(t){return function(t){return t.direction in G}(t)?function(t){var e=t.start,r=t.direction,n=t.length;return function(t,i){var o=[],a=t(null!=e?e:i);!e&&i&&(a=V(a,r));for(var s=0;s<n;s++)o.push(a),a=V(a,r);return o}}(t):function(t){var e=t.start,r=t.stop;return function(t,n){for(var i=[],o=t(null!=e?e:n),a=function(t,e){return function(r){return{q:t.q*(1-r)+e.q*r,r:t.r*(1-r)+e.r*r}}}(tt(o),tt(_(o,r))),s=K(o,o,r),u=1/Math.max(s,1),c=!e&&n?1:0;c<=s;c++){var l=F(a(u*c));i.push(t(l))}return i}}(t)}function tt(t){return{q:t.q+1e-6,r:t.r+1e-6,s:t.s+-2e-6}}G.E,G.N,G.S,G.W;var et=new WeakMap,rt=new WeakMap,nt=new WeakSet,it=new WeakSet,ot=new WeakSet,at=new WeakSet;n=Symbol.iterator;var st=function(){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(g(this,t),i(this,at),i(this,ot),i(this,it),i(this,nt),o(this,et,{writable:!0,value:void 0}),o(this,rt,{writable:!0,value:new Map}),e instanceof t)return u(this,et,c(e,et)),void this.setHexes(e);u(this,et,e),this.setHexes(s(this,it,ct).call(this,r))}return w(t,[{key:"size",get:function(){return c(this,rt).size}},{key:"pixelWidth",get:function(){if(0===this.size)return 0;var t=this.hexPrototype,e=t.isPointy,r=t.width,n=this.toArray(),i=e?n.sort(function(t,e){return e.s-t.s||t.q-e.q}):n.sort(function(t,e){return t.q-e.q}),o=i[0];return i[i.length-1].x-o.x+r}},{key:"pixelHeight",get:function(){if(0===this.size)return 0;var t=this.hexPrototype,e=t.isPointy,r=t.height,n=this.toArray(),i=e?n.sort(function(t,e){return t.r-e.r}):n.sort(function(t,e){return e.s-t.s||t.r-e.r}),o=i[0];return i[i.length-1].y-o.y+r}},{key:n,value:function(){return c(this,rt).values()}},{key:"hexPrototype",get:function(){return c(this,et).prototype}},{key:"createHex",value:function(t){return new(c(this,et))(t)}},{key:"getHex",value:function(t){var e=this.createHex(t);return c(this,rt).get(e.toString())}},{key:"hasHex",value:function(t){return c(this,rt).has(t.toString())}},{key:"setHexes",value:function(t){var e,r=f(t);try{for(r.s();!(e=r.n()).done;){var n=e.value,i=n instanceof R?n:new(c(this,et))(n);s(this,nt,ut).call(this,i)}}catch(t){r.e(t)}finally{r.f()}return this}},{key:"filter",value:function(e){var r,n=new t(c(this,et)),i=f(this);try{for(i.s();!(r=i.n()).done;){var o=r.value;e(o)&&s(n,nt,ut).call(n,o)}}catch(t){i.e(t)}finally{i.f()}return n}},{key:"map",value:function(e){var r,n=new t(c(this,et)),i=f(this);try{for(i.s();!(r=i.n()).done;){var o=r.value;s(n,nt,ut).call(n,e(o))}}catch(t){i.e(t)}finally{i.f()}return n}},{key:"traverse",value:function(e){var r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.bail,o=void 0!==i&&i,a=new t(c(this,et)),u=f(s(this,it,ct).call(this,e));try{for(u.s();!(r=u.n()).done;){var l=r.value,h=this.getHex(l);if(h)s(a,nt,ut).call(a,h);else if(o)return a}}catch(t){u.e(t)}finally{u.f()}return a}},{key:"forEach",value:function(t){var e,r=f(this);try{for(r.s();!(e=r.n()).done;)t(e.value)}catch(t){r.e(t)}finally{r.f()}return this}},{key:"reduce",value:function(t,e){if(void 0===e){var r,n,i,o,a=f(this);try{for(a.s();!(o=a.n()).done;){var s=o.value;n=i,i=s,n&&(r=t(n,i))}}catch(t){a.e(t)}finally{a.f()}return r}var u,c=e,l=f(this);try{for(l.s();!(u=l.n()).done;)c=t(c,u.value)}catch(t){l.e(t)}finally{l.f()}return c}},{key:"toArray",value:function(){return Array.from(this)}},{key:"toJSON",value:function(){var t=this.hexPrototype;return{hexSettings:{dimensions:t.dimensions,orientation:t.orientation,origin:t.origin,offset:t.offset},coordinates:this.toArray()}}},{key:"toString",value:function(){return"".concat(this.constructor.name,"(").concat(this.size,")")}},{key:"pointToHex",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.allowOutside,n=void 0===r||r,i=$(this.hexPrototype,t),o=this.getHex(i);return n?null!=o?o:this.createHex(i):o}},{key:"distance",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.allowOutside,i=void 0===n||n;if(i)return K(this.hexPrototype,t,e);var o=this.getHex(t),a=this.getHex(e);return o&&a?K(this.hexPrototype,o,a):void 0}},{key:"neighborOf",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.allowOutside,i=void 0===n||n,o=V(this.createHex(t),e),a=this.getHex(o);return i?null!=a?a:o:a}}],[{key:"fromIterable",value:function(e){var r=e[Symbol.iterator]().next().value;if(!r)throw new TypeError("Can't create grid from empty iterable: ".concat(JSON.stringify(e)));return new t(r.constructor,e)}},{key:"fromJSON",value:function(e){var r=e.hexSettings,n=e.coordinates,i=W(r);return new t(i,n.map(function(t){return new i(t)}))}}]),t}();function ut(t){c(this,rt).set(t.toString(),t)}function ct(t){return s(this,ot,lt).call(this,t)?s(this,at,ft).call(this,t):Array.isArray(t)&&s(this,ot,lt).call(this,t[0])?s(this,at,ft).call(this,X(t)):t}function lt(t){return"function"==typeof t}function ft(t){return t(this.createHex.bind(this))}const ht=200,yt=new st(W({dimensions:100,orientation:N.FLAT,origin:"topLeft"}),(vt={width:4,height:4},function(t,e){var r,n=vt.width,i=vt.height,o=vt.start,a=vt.direction,s=void 0===a?G.E:a,u=null!==(r=null!=o?o:e)&&void 0!==r?r:[0,0],c=function(t,e){var r=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).includeSource,n=void 0===r||r;return function(r,i){var o,a=[],s=f(X(t)(r,i));try{for(s.s();!(o=s.n()).done;){var u=o.value;n&&a.push(u);var c,l=f(X(e)(r,u));try{for(l.s();!(c=l.n()).done;){var h=c.value;a.push(h)}}catch(t){l.e(t)}finally{l.f()}}}catch(t){s.e(t)}finally{s.f()}return a}}(Z({start:u,direction:T(s,2),length:i}),Z({direction:s,length:n-1}))(t,u);return!o&&e?c.slice(1):c}));var vt;const dt=(()=>{const t=ht*(Math.sqrt(3)-1),e=ht*(2*Math.sqrt(2)-2),r=[{x:-2,y:0},{x:-1,y:0-Math.sqrt(3)},{x:1,y:0-Math.sqrt(3)},{x:2,y:0},{x:1,y:Math.sqrt(3)},{x:-1,y:Math.sqrt(3)}].map(t=>({x:t.x*ht/4+150,y:t.y*ht/4+150}));return{moveU:{src:"img/actions/moveU.png",polygon:r.map(r=>({x:r.x-t,y:r.y-e/2})),key:"u"},moveI:{src:"img/actions/moveI.png",polygon:r.map(t=>({x:t.x,y:t.y-e})),key:"i"},moveO:{src:"img/actions/moveO.png",polygon:r.map(r=>({x:r.x+t,y:r.y-e/2})),key:"o"},moveJ:{src:"img/actions/moveJ.png",polygon:r.map(r=>({x:r.x-t,y:r.y+e/2})),key:"j"},moveK:{src:"img/actions/moveK.png",polygon:r.map(t=>({x:t.x,y:t.y+e})),key:"k"},moveL:{src:"img/actions/moveL.png",polygon:r.map(r=>({x:r.x+t,y:r.y+e/2})),key:"l"}}})(),pt={players:[new gt],turn:0,activeUnit:null,currentPlayer:null,sprActiveUnit:null,startRound(){this.startTurn(0)},startTurn(t){if(!Number.isFinite(t))throw new TypeError(`Unknown player ${t}`);if(this.currentPlayer=this.players[t],!(this.currentPlayer instanceof gt))throw new TypeError(`Player ${t} is not a Player Object`);this.currentPlayer.units.forEach(t=>{t.moves=t.base.movementPoints}),this.currentPlayer.units[0].activate()},endTurn(){},endRound(){}};function gt(){const t=[];Object.defineProperties(this,{units:{get:()=>t}})}function mt(t,e,r){switch(t){case"moveU":r%2==0&&e--,r--;break;case"moveI":e--;break;case"moveO":r%2==0&&e--,r++;break;case"moveJ":r%2==1&&e++,r--;break;case"moveK":e++;break;case"moveL":r%2==1&&e++,r++;}return[e,r]}function wt(t,e,r,n){const i=json.world.units[t];if("object"!=typeof i||null===i)throw new TypeError(`Unknown unit '${t}'`);const{x:o,y:a}=yt.getHex({row:e,col:r}),s=n.add.sprite(o,a,`unit.${t}`);this.col=r,this.row=e,Object.defineProperties(this,{base:{enumerable:!0,get:()=>i},game:{enumerable:!0,get:()=>n},sprite:{enumerable:!0,get:()=>s}})}function bt(t){if(pt.currentPlayer!==pt.players[0])return!1;switch(t){case"moveU":case"moveI":case"moveO":case"moveJ":case"moveK":case"moveL":if("object"!=typeof pt.activeUnit||null===pt.activeUnit)return!1;pt.activeUnit.move(t);}}function xt(t,e,r){const n=yt.getHex({row:e,col:r});if(void 0===n)return!1;console.log("Sam, isLegalMove, target:",n),n.city,console.log("Sam, isLegalMove, unit:",t);const i=t.base.movementCosts[n.terrain];return!!Number.isFinite(i)&&i<=t.moves}Object.defineProperties(gt.prototype,{addUnit:{value(t,e,r,n){this.units.push(new wt(t,e,r,n))}}}),Object.assign(wt.prototype,{activate(){const{x:t,y:e}=yt.getHex({row:this.row,col:this.col});this.sprite.setDepth(100),pt.sprActiveUnit.setActive(!0).setPosition(t,e).setDepth(99),Object.entries(dt).forEach(_ref=>{let[r,n]=_ref;const[i,o]=mt(r,this.row,this.col);xt(this,i,o)?n.img.setActive(!0).setPosition(t,e).setDepth(98):n.img.setActive(!1).setPosition(-300,-300).setDepth(0)}),pt.activeUnit=this,this.game.input.keyboard.enabled=!0},deactivate(){pt.sprActiveUnit.setActive(!1).setPosition(-300,-300).setDepth(0),Object.entries(dt).forEach(_ref2=>{let[t,e]=_ref2;e.img.setActive(!1).setPosition(-300,-300).setDepth(0)}),pt.activeUnit=null,this.game.input.keyboard.enabled=!1},move(t){const[e,r]=mt(t,this.row,this.col);if(!xt(this,e,r))throw new Error("Tried to make illegal move!");this.row=e,this.col=r;const n=yt.getHex({row:this.row,col:this.col});this.sprite.setPosition(n.x,n.y).setDepth(1),this.moves-=this.base.movementCosts[n.terrain],this.moves>0?this.activate():this.deactivate()}});const Ot={type:Phaser.AUTO,height:1200,width:1600,zoom:.8,backgroundColor:"#71ABFF",scene:{preload(){Object.entries(json.world.terrains).forEach(_ref3=>{let[t,e]=_ref3;this.load.image(`tile.${t}`,`img/tiles/${e.tile}.png`)}),this.load.image("activeUnit","img/activeUnit.png"),Object.entries(dt).forEach(_ref4=>{let[t,e]=_ref4;this.load.image(t,e.src)}),Object.keys(json.world.units).forEach(t=>{this.load.image(`unit.${t}`,`img/units/${t}.png`)})},create(){yt.forEach(t=>{const e=json.world.world[t.row][t.col];Object.assign(t,e,{sprite:this.add.image(t.x,t.y,`tile.${e.terrain}`).setDepth(0),text:this.add.text(t.x-100,t.y+ht/3.6,t.row+"\xD7"+t.col,{fixedWidth:ht,font:"12pt Trebuchet MS",align:"center",color:"white"}).setOrigin(0)})}),pt.sprActiveUnit=this.add.image(-300,-300,"activeUnit").setActive(!1),Object.entries(dt).forEach(_ref5=>{let[t,e]=_ref5;e.img=this.add.image(-300,-300,t).setInteractive(new Phaser.Geom.Polygon(e.polygon),Phaser.Geom.Polygon.Contains).on("pointerdown",()=>{console.log("Sam, pointerdown on",t),bt(t)}).setActive(!1)}),pt.players[0].addUnit("warrior",Math.floor(2*Math.random()+1),Math.floor(3*Math.random()),this),console.log("Sam, players:",pt.players),console.log("Sam, unit 1:",pt.players[0].units[0]),this.input.keyboard.on("keydown-U",()=>{bt("moveU")}).on("keydown-I",()=>{bt("moveI")}).on("keydown-O",()=>{bt("moveO")}).on("keydown-J",()=>{bt("moveJ")}).on("keydown-K",()=>{bt("moveK")}).on("keydown-L",()=>{bt("moveL")}).enabled=!1,pt.startRound()},update(){}}};yodasws.page("pageGame").setRoute({template:"pages/game/game.html",canonicalRoute:"/game/",route:"/game/?"}).on("load",()=>{new Phaser.Game(Object.assign({},Ot,{parent:document.querySelector("main")}))})},746:t=>{"use strict";t.exports=JSON.parse("{\"terrains\":{\"ocean\":{\"tile\":\"ocean\"},\"lake\":{\"tile\":\"lake\"},\"grass\":{\"tile\":\"grass\"},\"desert\":{\"tile\":\"desert\"},\"mountain\":{\"tile\":\"mountains\"},\"hill\":{\"tile\":\"grass\"}},\"units\":{\"warrior\":{\"movementPoints\":1,\"movementCosts\":{\"ocean\":false,\"grass\":1,\"desert\":1,\"mountain\":1,\"hill\":1}}},\"world\":[[{\"terrain\":\"ocean\"},{\"terrain\":\"ocean\"},{\"terrain\":\"ocean\"},{\"terrain\":\"ocean\"}],[{\"terrain\":\"grass\"},{\"terrain\":\"grass\",\"river\":true},{\"terrain\":\"grass\"},{\"terrain\":\"lake\"}],[{\"terrain\":\"desert\"},{\"terrain\":\"desert\",\"river\":true},{\"terrain\":\"desert\"},{\"terrain\":\"hill\"}],[{\"terrain\":\"hill\"},{\"terrain\":\"mountain\"},{\"terrain\":\"hill\"},{\"terrain\":\"grass\"}]]}")}},e={};function r(n){var i=e[n];if(void 0!==i)return i.exports;var o=e[n]={exports:{}};return t[n](o,o.exports,r),o.exports}r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},window.json={},r(601),json.world=r(746),yodasws.page("home").setRoute({template:"pages/home.html",route:"/"}).on("load",()=>{})})();